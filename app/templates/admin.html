<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리 대시보드 - AI SEO Blog Generator</title>
    <!-- Bootstrap CSS & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/static/common.css">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@100;200;300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/eventsource@2.0.2/lib/eventsource.min.js"></script>
    <!-- 성능 최적화를 위한 지연 로딩 -->
    <script>
        // 차트 라이브러리 지연 로딩
        window.addEventListener('load', function () {
            if (typeof Chart !== 'undefined') {
                console.log('Chart.js 로딩 완료');
            }
        });
    </script>
    <link rel="stylesheet" href="/static/admin.css">
</head>

<body>
    <!-- 토스트 알림 컨테이너 -->
    <div class="toast-container" id="toast-container"></div>

    <!-- 사이드바 -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h3><i class="bi bi-gear-fill"></i> 관리 대시보드</h3>
            <div class="quick-actions">
                <a href="/" class="btn btn-modern btn-primary-modern btn-sm">
                    <i class="bi bi-house"></i> 콘텐츠 생성
                </a>
                <a href="/admin/new" class="btn btn-modern btn-success-modern btn-sm">
                    <i class="bi bi-arrow-up-circle"></i> 새로운 관리자
                </a>
            </div>
        </div>

        <nav class="sidebar-nav">
            <ul>
                <li>
                    <a href="#" class="nav-link active" onclick="showContent('dashboard')">
                        <i class="bi bi-speedometer2"></i>
                        <span>통계 대시보드</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" onclick="showContent('posts')">
                        <i class="bi bi-file-text"></i>
                        <span>포스트 관리</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" onclick="showContent('keywords')">
                        <i class="bi bi-tags"></i>
                        <span>키워드 관리</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" onclick="showContent('news')">
                        <i class="bi bi-newspaper"></i>
                        <span>뉴스 아카이브</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" onclick="showContent('updates')">
                        <i class="bi bi-clock-history"></i>
                        <span>업데이트 이력</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" onclick="showContent('system')">
                        <i class="bi bi-gear"></i>
                        <span>시스템 관리</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showContent('performance')">
                        <i class="bi bi-speedometer2"></i> 성능 모니터링
                        <span class="badge bg-success">실시간</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>

    <!-- 메인 콘텐츠 영역 -->
    <div class="main-content">
        <!-- 관리 대시보드 콘텐츠 -->
        <div id="dashboard-content" class="content-section active">
            <div class="content-header">
                <h1><i class="bi bi-speedometer2"></i> 관리 대시보드</h1>
                <p>시스템 전체 현황을 한눈에 확인하고 관리합니다.</p>

                <!-- 테스트 버튼 추가 -->
                <div class="test-buttons"
                    style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                    <button class="btn btn-sm btn-primary" onclick="testLoadPosts()">
                        <i class="bi bi-file-text me-1"></i>포스트 데이터 테스트
                    </button>
                    <button class="btn btn-sm btn-success" onclick="testLoadKeywords()">
                        <i class="bi bi-tags me-1"></i>키워드 데이터 테스트
                    </button>
                    <button class="btn btn-sm btn-warning" onclick="testLoadNews()">
                        <i class="bi bi-newspaper me-1"></i>뉴스 데이터 테스트
                    </button>
                    <button class="btn btn-sm btn-info" onclick="testMenuNavigation()">
                        <i class="bi bi-arrow-left-right me-1"></i>메뉴 네비게이션 테스트
                    </button>
                    <button class="btn btn-sm btn-secondary" onclick="testDashboardClick()">
                        <i class="bi bi-speedometer2 me-1"></i>대시보드 클릭 테스트
                    </button>
                    <button class="btn btn-sm btn-outline-primary" onclick="createTestSession()">
                        <i class="bi bi-shield-check me-1"></i>테스트 세션 생성
                    </button>
                    <button class="btn btn-sm btn-outline-success" onclick="testAdminIntegration()">
                        <i class="bi bi-check-circle me-1"></i>통합 테스트
                    </button>
                    <button class="btn btn-sm btn-outline-info" onclick="runPerformanceBenchmark()">
                        <i class="bi bi-speedometer2 me-1"></i>성능 벤치마크
                    </button>
                </div>
            </div>

            <div class="content-body">
                <!-- 주요 통계 카드 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-file-text"></i>
                        </div>
                        <div class="stat-number" id="total-posts">-</div>
                        <div class="stat-label">총 포스트</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-tags"></i>
                        </div>
                        <div class="stat-number" id="total-keywords">-</div>
                        <div class="stat-label">총 키워드</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-robot"></i>
                        </div>
                        <div class="stat-number" id="api-calls-today">-</div>
                        <div class="stat-label">오늘 API 호출</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-graph-up"></i>
                        </div>
                        <div class="stat-number" id="crawl-success-rate">-</div>
                        <div class="stat-label">크롤링 성공률</div>
                    </div>
                </div>

                <!-- 상세 통계 섹션 -->
                <div class="stats-sections">
                    <!-- API 사용량 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-robot"></i> API 사용량 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="api-stats-grid">
                                <div class="api-stat-item">
                                    <div class="api-stat-label">OpenAI API</div>
                                    <div class="api-stat-value" id="openai-calls">-</div>
                                    <div class="api-stat-change" id="openai-change">-</div>
                                </div>
                                <div class="api-stat-item">
                                    <div class="api-stat-label">Gemini API</div>
                                    <div class="api-stat-value" id="gemini-calls">-</div>
                                    <div class="api-stat-change" id="gemini-change">-</div>
                                </div>
                                <div class="api-stat-item">
                                    <div class="api-stat-label">번역 API</div>
                                    <div class="api-stat-value" id="translation-calls">-</div>
                                    <div class="api-stat-change" id="translation-change">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 포스트 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-file-text"></i> 포스트 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="post-stats-grid">
                                <div class="post-stat-item">
                                    <div class="post-stat-label">2000자 이하</div>
                                    <div class="post-stat-value" id="posts-2000">-</div>
                                </div>
                                <div class="post-stat-item">
                                    <div class="post-stat-label">3000자</div>
                                    <div class="post-stat-value" id="posts-3000">-</div>
                                </div>
                                <div class="post-stat-item">
                                    <div class="post-stat-label">4000자</div>
                                    <div class="post-stat-value" id="posts-4000">-</div>
                                </div>
                                <div class="post-stat-item">
                                    <div class="post-stat-label">5000자 이상</div>
                                    <div class="post-stat-value" id="posts-5000">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 업데이트 이력 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-clock-history"></i> 업데이트 이력 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="update-stats-grid">
                                <div class="update-stat-item">
                                    <div class="update-stat-label">총 업데이트</div>
                                    <div class="update-stat-value" id="total-updates">-</div>
                                </div>
                                <div class="update-stat-item">
                                    <div class="update-stat-label">UI/UX</div>
                                    <div class="update-stat-value" id="uiux-updates">-</div>
                                </div>
                                <div class="update-stat-item">
                                    <div class="update-stat-label">API</div>
                                    <div class="update-stat-value" id="api-updates">-</div>
                                </div>
                                <div class="update-stat-item">
                                    <div class="update-stat-label">AI</div>
                                    <div class="update-stat-value" id="ai-updates">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 상세 업데이트 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-graph-up"></i> 상세 업데이트 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="detailed-stats-grid">
                                <div class="detailed-stat-section">
                                    <h4>중요도별 분포</h4>
                                    <div class="stat-row">
                                        <span class="stat-label">높음</span>
                                        <span class="stat-value" id="high-importance">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">보통</span>
                                        <span class="stat-value" id="medium-importance">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">낮음</span>
                                        <span class="stat-value" id="low-importance">-</span>
                                    </div>
                                </div>

                                <div class="detailed-stat-section">
                                    <h4>영향도별 분포</h4>
                                    <div class="stat-row">
                                        <span class="stat-label">신규 기능</span>
                                        <span class="stat-value" id="new-features">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">기능 개선</span>
                                        <span class="stat-value" id="improvements">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">버그 수정</span>
                                        <span class="stat-value" id="bugfixes">-</span>
                                    </div>
                                </div>

                                <div class="detailed-stat-section">
                                    <h4>성능 지표</h4>
                                    <div class="stat-row">
                                        <span class="stat-label">완료율</span>
                                        <span class="stat-value" id="completion-rate">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">평균 중요도</span>
                                        <span class="stat-value" id="avg-importance">-</span>
                                    </div>
                                    <div class="stat-row">
                                        <span class="stat-label">개발 효율성</span>
                                        <span class="stat-value" id="dev-efficiency">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 키워드 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-tags"></i> 키워드 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="keyword-stats-grid">
                                <div class="keyword-stat-item">
                                    <div class="keyword-stat-label">AI</div>
                                    <div class="keyword-stat-value" id="keywords-ai">-</div>
                                </div>
                                <div class="keyword-stat-item">
                                    <div class="keyword-stat-label">SEO</div>
                                    <div class="keyword-stat-value" id="keywords-seo">-</div>
                                </div>
                                <div class="keyword-stat-item">
                                    <div class="keyword-stat-label">Tech</div>
                                    <div class="keyword-stat-value" id="keywords-tech">-</div>
                                </div>
                                <div class="keyword-stat-item">
                                    <div class="keyword-stat-label">Marketing</div>
                                    <div class="keyword-stat-value" id="keywords-marketing">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 뉴스 아카이브 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-newspaper"></i> 뉴스 아카이브 통계</h3>
                        </div>
                        <div class="card-body">
                            <div class="news-stats-grid">
                                <div class="news-stat-item">
                                    <div class="news-stat-label">AEO 뉴스</div>
                                    <div class="news-stat-value" id="aeo-news">-</div>
                                </div>
                                <div class="news-stat-item">
                                    <div class="news-stat-label">GEO 뉴스</div>
                                    <div class="news-stat-value" id="geo-news">-</div>
                                </div>
                                <div class="news-stat-item">
                                    <div class="news-stat-label">AIO 뉴스</div>
                                    <div class="news-stat-value" id="aio-news">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 시스템 성능 통계 -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="bi bi-cpu"></i> 시스템 성능</h3>
                        </div>
                        <div class="card-body">
                            <div class="system-stats-grid">
                                <div class="system-stat-item">
                                    <div class="system-stat-label">데이터베이스 크기</div>
                                    <div class="system-stat-value" id="db-size">-</div>
                                </div>
                                <div class="system-stat-item">
                                    <div class="system-stat-label">로그 파일 수</div>
                                    <div class="system-stat-value" id="log-files">-</div>
                                </div>
                                <div class="system-stat-item">
                                    <div class="system-stat-label">API 응답 시간</div>
                                    <div class="system-stat-value" id="api-response-time">-</div>
                                </div>
                                <div class="system-stat-item">
                                    <div class="system-stat-label">시스템 업타임</div>
                                    <div class="system-stat-value" id="system-uptime">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 포스트 관리 콘텐츠 -->
        <div id="posts-content" class="content-section">
            <div class="content-header">
                <h1><i class="bi bi-file-text"></i> 포스트 관리</h1>
                <p>생성된 블로그 포스트를 관리하고 분석합니다.</p>
                <div class="header-actions">
                    <button class="btn btn-modern btn-outline-primary" onclick="exportPosts()">
                        <i class="bi bi-download"></i> 내보내기
                    </button>
                    <button class="btn btn-modern btn-outline-danger" onclick="bulkDeletePosts()">
                        <i class="bi bi-trash"></i> 일괄 삭제
                    </button>
                </div>
            </div>

            <div class="content-body">
                <!-- 통계 카드 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-file-text"></i>
                        </div>
                        <div class="stat-number" id="total-posts">-</div>
                        <div class="stat-label">총 포스트</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-calendar-check"></i>
                        </div>
                        <div class="stat-number" id="today-posts">-</div>
                        <div class="stat-label">오늘 생성</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-graph-up"></i>
                        </div>
                        <div class="stat-number" id="avg-length">-</div>
                        <div class="stat-label">평균 길이</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-tags"></i>
                        </div>
                        <div class="stat-number" id="total-keywords">-</div>
                        <div class="stat-label">사용 키워드</div>
                    </div>
                </div>

                <!-- 검색 및 필터 -->
                <div class="search-filter-bar">
                    <input type="text" class="search-input" id="post-search" placeholder="포스트 제목으로 검색...">
                    <select class="filter-select" id="post-filter">
                        <option value="">전체</option>
                        <option value="today">오늘</option>
                        <option value="week">이번 주</option>
                        <option value="month">이번 달</option>
                    </select>
                    <button class="btn btn-modern btn-primary-modern" onclick="refreshPosts()">
                        <i class="bi bi-arrow-clockwise"></i> 새로고침
                    </button>
                </div>

                <!-- 포스트 목록 -->
                <div class="content-card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3>포스트 목록</h3>
                        <div class="d-flex gap-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="select-all-posts">
                                <label class="form-check-label" for="select-all-posts">
                                    전체 선택
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th width="50">
                                            <input type="checkbox" id="select-all-posts-checkbox">
                                        </th>
                                        <th>제목</th>
                                        <th>키워드</th>
                                        <th>길이</th>
                                        <th>생성일</th>
                                        <th>상태</th>
                                        <th width="150">작업</th>
                                    </tr>
                                </thead>
                                <tbody id="posts-table-body">
                                    <tr>
                                        <td colspan="7" class="text-center py-4">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">로딩 중...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 페이지네이션 -->
                        <nav aria-label="포스트 페이지네이션">
                            <ul class="pagination justify-content-center" id="posts-pagination">
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <!-- 키워드 관리 콘텐츠 -->
        <div id="keywords-content" class="content-section">
            <div class="content-header">
                <h1><i class="bi bi-tags"></i> 키워드 관리</h1>
                <p>SEO 키워드를 관리하고 분석합니다.</p>
                <div class="header-actions">
                    <button class="btn btn-modern btn-outline-success" onclick="addKeyword()">
                        <i class="bi bi-plus"></i> 키워드 추가
                    </button>
                    <button class="btn btn-modern btn-outline-primary" onclick="importKeywords()">
                        <i class="bi bi-upload"></i> 일괄 등록
                    </button>
                    <button class="btn btn-modern btn-outline-warning" onclick="analyzeKeywords()">
                        <i class="bi bi-graph-up"></i> 키워드 분석
                    </button>
                </div>
            </div>

            <div class="content-body">
                <!-- 통계 카드 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-tags"></i>
                        </div>
                        <div class="stat-number" id="total-keywords-count">-</div>
                        <div class="stat-label">총 키워드</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-robot"></i>
                        </div>
                        <div class="stat-number" id="ai-keywords">-</div>
                        <div class="stat-label">AI 관련</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-search"></i>
                        </div>
                        <div class="stat-number" id="seo-keywords">-</div>
                        <div class="stat-label">SEO 관련</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-code-slash"></i>
                        </div>
                        <div class="stat-number" id="tech-keywords">-</div>
                        <div class="stat-label">기술 관련</div>
                    </div>
                </div>

                <!-- 검색 및 필터 -->
                <div class="search-filter-bar">
                    <input type="text" class="search-input" id="keyword-search" placeholder="키워드로 검색...">
                    <select class="filter-select" id="keyword-filter">
                        <option value="">전체 카테고리</option>
                        <option value="ai">AI</option>
                        <option value="seo">SEO</option>
                        <option value="tech">기술</option>
                        <option value="marketing">마케팅</option>
                        <option value="business">비즈니스</option>
                        <option value="trend">트렌드</option>
                        <option value="howto">하우투</option>
                    </select>
                    <button class="btn btn-modern btn-primary-modern" onclick="searchKeywords()">
                        <i class="bi bi-search"></i> 검색
                    </button>
                    <button class="btn btn-modern btn-secondary-modern" onclick="refreshKeywords()">
                        <i class="bi bi-arrow-clockwise"></i> 새로고침
                    </button>
                </div>

                <!-- 키워드 목록 -->
                <div class="content-card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3>키워드 목록</h3>
                        <div class="d-flex gap-2">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="select-all-keywords">
                                <label class="form-check-label" for="select-all-keywords">
                                    전체 선택
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th width="50">
                                            <input type="checkbox" id="select-all-keywords-checkbox">
                                        </th>
                                        <th>키워드</th>
                                        <th>카테고리</th>
                                        <th>검색량</th>
                                        <th>경쟁도</th>
                                        <th>상태</th>
                                        <th>사용 횟수</th>
                                        <th width="150">작업</th>
                                    </tr>
                                </thead>
                                <tbody id="keywords-table-body">
                                    <tr>
                                        <td colspan="8" class="text-center py-4">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">로딩 중...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 페이지네이션 -->
                        <nav aria-label="키워드 페이지네이션">
                            <ul class="pagination justify-content-center" id="keywords-pagination">
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <!-- 뉴스 아카이브 콘텐츠 -->
        <div id="news-content" class="content-section">
            <div class="content-header">
                <h1><i class="bi bi-newspaper"></i> 뉴스 아카이브</h1>
                <p>AEO, GEO, AIO 관련 뉴스를 수집하고 관리합니다.</p>
            </div>

            <div class="content-body">
                <!-- 뉴스 수집 버튼 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-cloud-download"></i> 뉴스 수집</h3>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-modern btn-primary-modern" onclick="collectNews()">
                            <i class="bi bi-cloud-download"></i> 뉴스 수집 시작
                        </button>
                        <div id="collection-status" class="mt-3" style="display: none;">
                            <div class="alert alert-info">
                                <i class="bi bi-hourglass-split"></i> 뉴스를 수집하고 있습니다...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 뉴스 통계 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-newspaper"></i>
                        </div>
                        <div class="stat-number" id="total-news">-</div>
                        <div class="stat-label">총 뉴스</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-award"></i>
                        </div>
                        <div class="stat-number" id="aeo-news-count">-</div>
                        <div class="stat-label">AEO 뉴스</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-robot"></i>
                        </div>
                        <div class="stat-number" id="geo-news-count">-</div>
                        <div class="stat-label">GEO 뉴스</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-gear"></i>
                        </div>
                        <div class="stat-number" id="aio-news-count">-</div>
                        <div class="stat-label">AIO 뉴스</div>
                    </div>
                </div>

                <!-- 검색 및 필터 -->
                <div class="search-filter-bar">
                    <input type="text" class="search-input" id="news-search" placeholder="뉴스 제목으로 검색...">
                    <select class="filter-select" id="news-filter">
                        <option value="">전체 카테고리</option>
                        <option value="AEO">AEO</option>
                        <option value="GEO">GEO</option>
                        <option value="AIO">AIO</option>
                    </select>
                    <button class="btn btn-modern btn-primary-modern" onclick="refreshNews()">
                        <i class="bi bi-arrow-clockwise"></i> 뉴스 목록 새로고침
                    </button>
                </div>

                <!-- 뉴스 목록 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3>뉴스 목록</h3>
                    </div>
                    <div class="card-body">
                        <div id="news-container">
                            <!-- 뉴스 목록이 여기에 로드됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 업데이트 이력 콘텐츠 -->
        <div id="updates-content" class="content-section">
            <div class="content-header">
                <h1><i class="bi bi-clock-history"></i> 업데이트 이력</h1>
                <p>서비스 업데이트 및 변경 이력을 확인합니다.</p>
            </div>

            <div class="content-body">
                <!-- 통계 카드 (숨김 처리) -->
                <div class="stats-grid" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-clock-history"></i>
                        </div>
                        <div class="stat-number" id="total-updates">-</div>
                        <div class="stat-label">총 업데이트</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-palette"></i>
                        </div>
                        <div class="stat-number" id="uiux-updates">-</div>
                        <div class="stat-label">UI/UX</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-gear"></i>
                        </div>
                        <div class="stat-number" id="api-updates">-</div>
                        <div class="stat-label">API</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-robot"></i>
                        </div>
                        <div class="stat-number" id="ai-updates">-</div>
                        <div class="stat-label">AI</div>
                    </div>
                </div>

                <!-- 검색 및 필터 -->
                <div class="search-filter-bar">
                    <input type="text" class="search-input" id="updates-search" placeholder="업데이트 내용으로 검색...">
                    <select class="filter-select" id="updates-filter">
                        <option value="">전체 카테고리</option>
                        <option value="UI/UX">UI/UX</option>
                        <option value="API">API</option>
                        <option value="AI">AI</option>
                        <option value="성능">성능</option>
                        <option value="크롤링">크롤링</option>
                        <option value="통계">통계</option>
                        <option value="번역">번역</option>
                        <option value="데이터">데이터</option>
                        <option value="보안">보안</option>
                        <option value="버그수정">버그수정</option>
                        <option value="기타">기타</option>
                    </select>
                    <button class="btn btn-modern btn-primary-modern" onclick="refreshUpdates()">
                        <i class="bi bi-arrow-clockwise"></i> 업데이트 이력 새로고침
                    </button>
                </div>

                <!-- 업데이트 이력 목록 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3>업데이트 이력</h3>
                    </div>
                    <div class="card-body">
                        <div id="updates-container">
                            <!-- 업데이트 이력이 여기에 로드됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 시스템 관리 콘텐츠 -->
        <div id="system-content" class="content-section">
            <div class="content-header">
                <h1><i class="bi bi-gear"></i> 시스템 관리</h1>
                <p>시스템 성능, 데이터베이스, API 사용량, 로그 등을 종합적으로 관리합니다.</p>
                <div class="header-actions">
                    <button class="btn btn-modern btn-primary-modern" onclick="refreshSystemData()">
                        <i class="bi bi-arrow-clockwise"></i> 시스템 데이터 새로고침
                    </button>
                </div>
            </div>

            <div class="content-body">
                <!-- 시스템 개요 통계 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon primary">
                            <i class="bi bi-cpu"></i>
                        </div>
                        <div class="stat-number" id="system-uptime">-</div>
                        <div class="stat-label">시스템 가동시간</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon success">
                            <i class="bi bi-database"></i>
                        </div>
                        <div class="stat-number" id="db-size">-</div>
                        <div class="stat-label">데이터베이스 크기</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="bi bi-speedometer2"></i>
                        </div>
                        <div class="stat-number" id="api-response-time">-</div>
                        <div class="stat-label">평균 응답시간</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon info">
                            <i class="bi bi-file-earmark-text"></i>
                        </div>
                        <div class="stat-number" id="log-files-count">-</div>
                        <div class="stat-label">로그 파일 수</div>
                    </div>
                </div>

                <!-- 성능 모니터링 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-speedometer"></i> 백그라운드 성능 모니터링</h3>
                        <div class="header-actions">
                            <button class="btn btn-sm btn-outline-primary" onclick="restartPerformanceMonitor()">
                                <i class="bi bi-arrow-clockwise"></i> 모니터링 재시작
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- 성능 모니터링 상태 -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-icon primary">
                                        <i class="bi bi-play-circle"></i>
                                    </div>
                                    <div class="stat-number" id="performance-status">-</div>
                                    <div class="stat-label">모니터링 상태</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-icon success">
                                        <i class="bi bi-database"></i>
                                    </div>
                                    <div class="stat-number" id="performance-data-points">-</div>
                                    <div class="stat-label">데이터 포인트</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-icon warning">
                                        <i class="bi bi-clock"></i>
                                    </div>
                                    <div class="stat-number" id="performance-last-update">-</div>
                                    <div class="stat-label">마지막 업데이트</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <div class="stat-icon info">
                                        <i class="bi bi-graph-up"></i>
                                    </div>
                                    <div class="stat-number" id="performance-test-interval">-</div>
                                    <div class="stat-label">테스트 간격</div>
                                </div>
                            </div>
                        </div>

                        <!-- 성능 요약 -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h5>시스템 성능 요약 (24시간)</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <tbody id="performance-summary">
                                            <tr>
                                                <td>CPU 사용률 (평균)</td>
                                                <td id="avg-cpu-usage">-</td>
                                            </tr>
                                            <tr>
                                                <td>CPU 사용률 (최대)</td>
                                                <td id="max-cpu-usage">-</td>
                                            </tr>
                                            <tr>
                                                <td>메모리 사용률 (평균)</td>
                                                <td id="avg-memory-usage">-</td>
                                            </tr>
                                            <tr>
                                                <td>메모리 사용률 (최대)</td>
                                                <td id="max-memory-usage">-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>API 성능 요약 (24시간)</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <tbody id="api-performance-summary">
                                            <tr>
                                                <td>API 성공률</td>
                                                <td id="api-success-rate">-</td>
                                            </tr>
                                            <tr>
                                                <td>평균 응답시간</td>
                                                <td id="api-avg-response-time">-</td>
                                            </tr>
                                            <tr>
                                                <td>최대 응답시간</td>
                                                <td id="api-max-response-time">-</td>
                                            </tr>
                                            <tr>
                                                <td>콘텐츠 생성 성공률</td>
                                                <td id="content-success-rate">-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- 성능 차트 -->
                        <div class="row">
                            <div class="col-md-6">
                                <h5>시스템 리소스 사용률</h5>
                                <canvas id="performanceResourcesChart" width="400" height="200"></canvas>
                            </div>
                            <div class="col-md-6">
                                <h5>API 응답시간 추이</h5>
                                <canvas id="performanceApiChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 시스템 성능 모니터링 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-graph-up"></i> 시스템 성능 모니터링</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>API 응답시간 추이</h5>
                                <canvas id="apiResponseChart" width="400" height="200"></canvas>
                            </div>
                            <div class="col-md-6">
                                <h5>데이터베이스 사용량</h5>
                                <canvas id="dbUsageChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h5>일별 API 호출량</h5>
                                <canvas id="apiCallsChart" width="400" height="200"></canvas>
                            </div>
                            <div class="col-md-6">
                                <h5>시스템 리소스 사용률</h5>
                                <canvas id="systemResourcesChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 데이터베이스 관리 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-database-gear"></i> 데이터베이스 관리</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>테이블별 데이터 현황</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>테이블명</th>
                                                <th>레코드 수</th>
                                                <th>크기</th>
                                                <th>마지막 업데이트</th>
                                            </tr>
                                        </thead>
                                        <tbody id="db-tables-info">
                                            <!-- 데이터베이스 테이블 정보가 여기에 로드됩니다 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>데이터베이스 작업</h5>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-modern btn-primary-modern" onclick="backupDatabase()">
                                        <i class="bi bi-download"></i> 데이터베이스 백업
                                    </button>
                                    <button class="btn btn-modern btn-warning-modern" onclick="optimizeDatabase()">
                                        <i class="bi bi-tools"></i> 데이터베이스 최적화
                                    </button>
                                    <button class="btn btn-modern btn-info-modern" onclick="cleanupLogs()">
                                        <i class="bi bi-trash"></i> 로그 파일 정리
                                    </button>
                                    <button class="btn btn-modern btn-danger-modern" onclick="resetSystem()">
                                        <i class="bi bi-arrow-clockwise"></i> 시스템 초기화
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API 사용량 분석 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-robot"></i> API 사용량 분석</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h5>API별 사용량 통계</h5>
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>API 서비스</th>
                                                <th>오늘 호출</th>
                                                <th>이번 주</th>
                                                <th>이번 달</th>
                                                <th>성공률</th>
                                                <th>평균 응답시간</th>
                                            </tr>
                                        </thead>
                                        <tbody id="api-usage-stats">
                                            <!-- API 사용량 통계가 여기에 로드됩니다 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <h5>API 키 관리</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>서비스</th>
                                                <th>상태</th>
                                                <th>작업</th>
                                            </tr>
                                        </thead>
                                        <tbody id="api-keys-status">
                                            <!-- API 키 상태가 여기에 로드됩니다 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 로그 모니터링 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-journal-text"></i> 로그 모니터링</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <h5>로그 레벨별 통계</h5>
                                <canvas id="logLevelChart" width="300" height="200"></canvas>
                            </div>
                            <div class="col-md-8">
                                <h5>최근 로그 (실시간)</h5>
                                <div class="log-container" id="recent-logs"
                                    style="height: 300px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 0.9rem;">
                                    <!-- 실시간 로그가 여기에 표시됩니다 -->
                                </div>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-modern btn-primary-modern" onclick="refreshLogs()">
                                        <i class="bi bi-arrow-clockwise"></i> 로그 새로고침
                                    </button>
                                    <button class="btn btn-sm btn-modern btn-success-modern" onclick="downloadLogs()">
                                        <i class="bi bi-download"></i> 로그 다운로드
                                    </button>
                                    <button class="btn btn-sm btn-modern btn-warning-modern" onclick="clearLogs()">
                                        <i class="bi bi-trash"></i> 로그 정리
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 시스템 설정 -->
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="bi bi-sliders"></i> 시스템 설정</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>일반 설정</h5>
                                <div class="mb-3">
                                    <label class="form-label">디버그 모드</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="debug-mode">
                                        <label class="form-check-label" for="debug-mode">디버그 모드 활성화</label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">로그 레벨</label>
                                    <select class="form-select" id="log-level">
                                        <option value="DEBUG">DEBUG</option>
                                        <option value="INFO">INFO</option>
                                        <option value="WARNING">WARNING</option>
                                        <option value="ERROR">ERROR</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">자동 백업 주기 (일)</label>
                                    <input type="number" class="form-control" id="backup-interval" value="7" min="1"
                                        max="30">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>성능 설정</h5>
                                <div class="mb-3">
                                    <label class="form-label">API 응답 캐시 시간 (초)</label>
                                    <input type="number" class="form-control" id="cache-duration" value="300" min="60"
                                        max="3600">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">최대 동시 요청 수</label>
                                    <input type="number" class="form-control" id="max-concurrent-requests" value="10"
                                        min="1" max="50">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">세션 타임아웃 (분)</label>
                                    <input type="number" class="form-control" id="session-timeout" value="30" min="5"
                                        max="120">
                                </div>
                                <button class="btn btn-modern btn-primary-modern" onclick="saveSystemSettings()">
                                    <i class="bi bi-save"></i> 설정 저장
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 성능 모니터링 콘텐츠 -->
    <div id="performance-content" class="content-section">
        <div class="content-header">
            <h1><i class="bi bi-speedometer2"></i> 성능 모니터링</h1>
            <p>실시간 시스템 성능, API 응답시간, 콘텐츠 생성 성능을 모니터링합니다.</p>
            <div class="header-actions">
                <button class="btn btn-modern btn-primary-modern" onclick="refreshPerformanceData()">
                    <i class="bi bi-arrow-clockwise"></i> 성능 데이터 새로고침
                </button>
                <button class="btn btn-modern btn-success-modern" onclick="restartPerformanceMonitor()">
                    <i class="bi bi-play-circle"></i> 모니터링 재시작
                </button>
            </div>
        </div>

        <div class="content-body">
            <!-- 실시간 성능 통계 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon primary">
                        <i class="bi bi-cpu"></i>
                    </div>
                    <div class="stat-number" id="real-time-cpu">-</div>
                    <div class="stat-label">실시간 CPU</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon warning">
                        <i class="bi bi-memory"></i>
                    </div>
                    <div class="stat-number" id="real-time-memory">-</div>
                    <div class="stat-label">실시간 메모리</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon success">
                        <i class="bi bi-lightning"></i>
                    </div>
                    <div class="stat-number" id="api-response-avg">-</div>
                    <div class="stat-label">API 응답시간</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon info">
                        <i class="bi bi-robot"></i>
                    </div>
                    <div class="stat-number" id="content-generation-status">-</div>
                    <div class="stat-label">콘텐츠 생성</div>
                </div>
            </div>

            <!-- 성능 차트 -->
            <div class="content-card">
                <div class="card-header">
                    <h3><i class="bi bi-graph-up"></i> 성능 트렌드 (최근 24시간)</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>시스템 리소스 사용률</h5>
                            <canvas id="systemPerformanceChart" width="400" height="200"></canvas>
                        </div>
                        <div class="col-md-6">
                            <h5>API 응답시간 트렌드</h5>
                            <canvas id="apiPerformanceChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 성능 알림 및 이슈 -->
            <div class="content-card">
                <div class="card-header">
                    <h3><i class="bi bi-exclamation-triangle"></i> 성능 알림</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>최근 알림</h5>
                            <div class="alert-container" id="performance-alerts"
                                style="max-height: 300px; overflow-y: auto;">
                                <!-- 성능 알림이 여기에 표시됩니다 -->
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5>성능 임계값 설정</h5>
                            <div class="threshold-settings">
                                <div class="mb-3">
                                    <label class="form-label">CPU 사용률 임계값 (%)</label>
                                    <input type="number" class="form-control" id="cpu-threshold" value="90" min="0"
                                        max="100">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">메모리 사용률 임계값 (%)</label>
                                    <input type="number" class="form-control" id="memory-threshold" value="85" min="0"
                                        max="100">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">API 응답시간 임계값 (ms)</label>
                                    <input type="number" class="form-control" id="response-threshold" value="5000"
                                        min="0">
                                </div>
                                <button class="btn btn-modern btn-primary-modern"
                                    onclick="updatePerformanceThresholds()">
                                    <i class="bi bi-save"></i> 임계값 저장
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 성능 데이터 상세 -->
            <div class="content-card">
                <div class="card-header">
                    <h3><i class="bi bi-table"></i> 성능 데이터 상세</h3>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>시간</th>
                                    <th>CPU (%)</th>
                                    <th>메모리 (%)</th>
                                    <th>API 응답시간 (ms)</th>
                                    <th>콘텐츠 생성</th>
                                    <th>상태</th>
                                </tr>
                            </thead>
                            <tbody id="performance-data-table">
                                <!-- 성능 데이터가 여기에 표시됩니다 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 포스트 상세보기 모달 -->
    <div class="modal fade" id="postDetailModal" tabindex="-1" aria-labelledby="postDetailModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="postDetailModalLabel">
                        <i class="bi bi-file-text"></i> 포스트 상세보기
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <!-- 포스트 내용 -->
                            <div class="post-content-section">
                                <h6 class="section-title">포스트 내용</h6>
                                <div class="post-content" id="modal-post-content">
                                    <div class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split"></i> 로딩 중...
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <!-- 포스트 메타데이터 -->
                            <div class="post-meta-section">
                                <h6 class="section-title">포스트 정보</h6>
                                <div class="post-meta" id="modal-post-meta">
                                    <div class="meta-item">
                                        <span class="meta-label">제목:</span>
                                        <span class="meta-value" id="modal-post-title">-</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">키워드:</span>
                                        <span class="meta-value" id="modal-post-keywords">-</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">단어 수:</span>
                                        <span class="meta-value" id="modal-post-word-count">-</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">생성일:</span>
                                        <span class="meta-value" id="modal-post-created">-</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">원본 URL:</span>
                                        <span class="meta-value" id="modal-post-url">-</span>
                                    </div>
                                </div>

                                <!-- SEO 분석 결과 -->
                                <div class="seo-analysis-section mt-4">
                                    <h6 class="section-title">SEO 분석 결과</h6>
                                    <div class="seo-analysis" id="modal-seo-analysis">
                                        <div class="text-center text-muted py-2">
                                            <i class="bi bi-info-circle"></i> SEO 분석 정보가 없습니다.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                    <button type="button" class="btn btn-primary" onclick="copyPostContent()">
                        <i class="bi bi-clipboard"></i> 내용 복사
                    </button>
                    <button type="button" class="btn btn-success" onclick="downloadPostContent()">
                        <i class="bi bi-download"></i> 다운로드
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 키워드 추가/편집 모달 -->
    <div class="modal fade" id="keywordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="keywordModalTitle">
                        <i class="bi bi-tags"></i> 키워드 추가
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="keywordForm">
                        <div class="mb-3">
                            <label for="keyword-input" class="form-label">키워드</label>
                            <input type="text" class="form-control" id="keyword-input" required>
                        </div>
                        <div class="mb-3">
                            <label for="keyword-category" class="form-label">카테고리</label>
                            <select class="form-select" id="keyword-category" required>
                                <option value="">카테고리 선택</option>
                                <option value="ai">AI</option>
                                <option value="seo">SEO</option>
                                <option value="tech">기술</option>
                                <option value="marketing">마케팅</option>
                                <option value="business">비즈니스</option>
                                <option value="trend">트렌드</option>
                                <option value="howto">하우투</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="keyword-description" class="form-label">설명</label>
                            <textarea class="form-control" id="keyword-description" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="keyword-volume" class="form-label">예상 검색량</label>
                                    <input type="number" class="form-control" id="keyword-volume" min="0">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="keyword-competition" class="form-label">경쟁도</label>
                                    <select class="form-select" id="keyword-competition">
                                        <option value="low">낮음</option>
                                        <option value="medium">보통</option>
                                        <option value="high">높음</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="keyword-status" class="form-label">상태</label>
                            <select class="form-select" id="keyword-status">
                                <option value="active">활성</option>
                                <option value="inactive">비활성</option>
                                <option value="pending">대기</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" onclick="saveKeyword()">
                        <i class="bi bi-save"></i> 저장
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 키워드 분석 모달 -->
    <div class="modal fade" id="keywordAnalysisModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-graph-up"></i> 키워드 분석
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>키워드 분포</h6>
                            <canvas id="keywordAnalysisChart"></canvas>
                        </div>
                        <div class="col-md-6">
                            <h6>인기 키워드</h6>
                            <div id="popular-keywords" class="border rounded p-3">
                                <!-- 인기 키워드 목록이 여기에 표시됩니다 -->
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <h6>키워드 추천</h6>
                            <div id="keyword-recommendations" class="border rounded p-3">
                                <!-- 키워드 추천이 여기에 표시됩니다 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 전역 변수
        let currentSection = 'dashboard';

        // 포스트 관리 관련 변수들
        let postsData = [];
        let currentPage = 1;
        let postsPerPage = 10;
        let selectedPosts = new Set();

        // 키워드 관리 관련 변수들
        let keywordsData = [];
        let currentKeywordPage = 1;
        let keywordsPerPage = 10;
        let selectedKeywords = new Set();
        let editingKeywordId = null;

        // 전역 데이터 캐시 및 상태 관리
        const DataManager = {
            cache: {},
            loadingStates: {},
            lastUpdated: {},

            // 캐시 TTL (5분)
            CACHE_TTL: 5 * 60 * 1000,

            // 데이터가 유효한지 확인
            isCacheValid(key) {
                const lastUpdate = this.lastUpdated[key];
                if (!lastUpdate) return false;
                return (Date.now() - lastUpdate) < this.CACHE_TTL;
            },

            // 캐시된 데이터 가져오기
            getCachedData(key) {
                if (this.isCacheValid(key)) {
                    console.log(`캐시된 데이터 사용: ${key}`);
                    return this.cache[key];
                }
                return null;
            },

            // 데이터 캐시에 저장
            setCachedData(key, data) {
                this.cache[key] = data;
                this.lastUpdated[key] = Date.now();
                console.log(`데이터 캐시 저장: ${key}`);
            },

            // 캐시 무효화
            invalidateCache(key) {
                if (key) {
                    delete this.cache[key];
                    delete this.lastUpdated[key];
                    console.log(`캐시 무효화: ${key}`);
                } else {
                    this.cache = {};
                    this.lastUpdated = {};
                    console.log('모든 캐시 무효화');
                }
            },

            // 로딩 상태 관리
            setLoading(key, loading) {
                this.loadingStates[key] = loading;
            },

            isLoading(key) {
                return this.loadingStates[key] || false;
            }
        };

        // 테스트 함수들
        async function testLoadPosts() {
            console.log('=== 포스트 데이터 테스트 시작 ===');
            try {
                const response = await fetch('/api/v1/posts');
                const posts = await response.json();
                console.log('포스트 데이터:', posts.length, '개');
                console.log('첫 번째 포스트:', posts[0]);

                // 포스트 섹션으로 이동하고 데이터 표시
                showContent('posts');
                updatePostsContainer(posts);

                showToast(`포스트 데이터 로드 완료: ${posts.length}개`, 'success');
            } catch (error) {
                console.error('포스트 테스트 오류:', error);
                showToast('포스트 데이터 로드 실패', 'error');
            }
        }

        async function testLoadKeywords() {
            console.log('=== 키워드 데이터 테스트 시작 ===');
            try {
                const response = await fetch('/api/v1/keywords');
                const keywords = await response.json();
                console.log('키워드 데이터:', keywords.length, '개');
                console.log('첫 번째 키워드:', keywords[0]);

                // 키워드 섹션으로 이동하고 데이터 표시
                showContent('keywords');
                updateKeywordsContainer(keywords);

                showToast(`키워드 데이터 로드 완료: ${keywords.length}개`, 'success');
            } catch (error) {
                console.error('키워드 테스트 오류:', error);
                showToast('키워드 데이터 로드 실패', 'error');
            }
        }

        async function testLoadNews() {
            console.log('=== 뉴스 데이터 테스트 시작 ===');
            try {
                const response = await fetch('/api/v1/news-archive/');
                const news = await response.json();
                console.log('뉴스 데이터:', news.length, '개');
                console.log('첫 번째 뉴스:', news[0]);

                // 뉴스 섹션으로 이동하고 데이터 표시
                showContent('news');
                updateNewsContainer(news);

                showToast(`뉴스 데이터 로드 완료: ${news.length}개`, 'success');
            } catch (error) {
                console.error('뉴스 테스트 오류:', error);
                showToast('뉴스 데이터 로드 실패', 'error');
            }
        }

        function testDashboardClick() {
            console.log('=== 대시보드 클릭 테스트 시작 ===');

            // 1. 대시보드 메뉴 요소 찾기
            const dashboardLink = document.querySelector('.nav-link[onclick*="showContent(\'dashboard\')"]');
            if (dashboardLink) {
                console.log('대시보드 메뉴 요소 발견:', dashboardLink);

                // 2. 클릭 이벤트 시뮬레이션
                console.log('대시보드 메뉴 클릭 시뮬레이션');
                dashboardLink.click();

                // 3. 직접 함수 호출
                setTimeout(() => {
                    console.log('직접 showContent 호출');
                    showContent('dashboard');
                }, 500);

                // 4. 데이터 로드 테스트
                setTimeout(() => {
                    console.log('직접 데이터 로드 테스트');
                    loadSectionDataDirect('dashboard');
                }, 1000);

                showToast('대시보드 클릭 테스트 완료', 'success');
            } else {
                console.error('대시보드 메뉴 요소를 찾을 수 없음');
                showToast('대시보드 메뉴 요소를 찾을 수 없음', 'error');
            }
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function () {
            console.log('관리 대시보드 초기화 시작');

            // 디버깅: 모든 섹션 확인
            const sections = ['dashboard', 'posts', 'keywords', 'news', 'updates', 'system'];
            sections.forEach(section => {
                const element = document.getElementById(`${section}-content`);
                console.log(`${section}-content 존재:`, !!element);
            });

            // 디버깅: 모든 메뉴 확인
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                console.log('메뉴 링크:', link.textContent.trim(), 'onclick:', link.getAttribute('onclick'));
            });

            // 초기화 순서 개선
            try {
                initializeAdmin();

                // 기본적으로 대시보드 표시 (지연 처리)
                setTimeout(() => {
                    console.log('대시보드 초기 표시 시작');
                    showContent('dashboard');
                }, 200);

                setupSearchAndFilter(); // 검색 및 필터 기능 초기화

                // 즉시 모든 데이터 로드 테스트
                console.log('즉시 데이터 로드 테스트 시작');
                loadAllData();

                // 업데이트 이력 통계도 즉시 로드
                setTimeout(() => {
                    console.log('업데이트 이력 통계 초기 로드 시작');
                    loadUpdatesData();

                    // 강제로 통계 업데이트 (페이지 로드 시)
                    fetch('/api/v1/feature-updates/history')
                        .then(response => response.json())
                        .then(data => {
                            console.log('페이지 로드 시 강제 통계 업데이트:', data.length, '개');
                            forceUpdateStats(data);

                            // 지연 후 한 번 더 시도
                            setTimeout(() => {
                                console.log('페이지 로드 후 지연 강제 업데이트');
                                forceUpdateStats(data);
                            }, 1000);
                        })
                        .catch(error => {
                            console.error('페이지 로드 시 통계 업데이트 오류:', error);
                        });
                }, 500);

            } catch (error) {
                console.error('관리 대시보드 초기화 오류:', error);
                showToast('관리 대시보드 초기화 중 오류가 발생했습니다.', 'error');
            }
        });

        // 모든 데이터를 즉시 로드하는 함수
        async function loadAllData() {
            console.log('=== 모든 데이터 즉시 로드 시작 ===');

            try {
                // 1. 포스트 데이터
                console.log('1. 포스트 데이터 로드');
                const postsResponse = await fetch('/api/v1/posts');
                const posts = await postsResponse.json();
                console.log('포스트 데이터 로드 완료:', posts.length, '개');

                // 2. 키워드 데이터
                console.log('2. 키워드 데이터 로드');
                const keywordsResponse = await fetch('/api/v1/keywords');
                const keywords = await keywordsResponse.json();
                console.log('키워드 데이터 로드 완료:', keywords.length, '개');

                // 3. 뉴스 데이터
                console.log('3. 뉴스 데이터 로드');
                const newsResponse = await fetch('/api/v1/news-archive/');
                const news = await newsResponse.json();
                console.log('뉴스 데이터 로드 완료:', news.length, '개');

                // 4. 통계 데이터
                console.log('4. 통계 데이터 로드');
                const statsResponse = await fetch('/api/v1/stats/dashboard');
                const stats = await statsResponse.json();
                console.log('통계 데이터 로드 완료');

                // 5. 업데이트 이력 데이터
                console.log('5. 업데이트 이력 데이터 로드');
                const updatesResponse = await fetch('/api/v1/feature-updates/history');
                const updates = await updatesResponse.json();
                console.log('업데이트 이력 데이터 로드 완료:', updates.length, '개');

                // 6. 모든 컨테이너 업데이트
                console.log('6. 모든 컨테이너 업데이트');
                updatePostsContainer(posts);
                updateKeywordsContainer(keywords);
                updateNewsContainer(news);
                updateDashboardContainer(posts, keywords, stats);
                updateUpdatesContainer(updates);
                updateUpdatesStats(updates);
                updateUpdateHistoryStats(updates);
                updateDetailedStats(updates);

                console.log('=== 모든 데이터 로드 및 표시 완료 ===');

            } catch (error) {
                console.error('데이터 로드 중 오류:', error);
            }
        }

        // 백그라운드에서 데이터 미리 로드
        async function preloadData() {
            console.log('백그라운드 데이터 미리 로드 시작');

            try {
                // 병렬로 모든 데이터 미리 로드
                await Promise.allSettled([
                    preloadPostsData(),
                    preloadKeywordsData(),
                    preloadNewsData(),
                    preloadUpdatesData(),
                    preloadSystemData()
                ]);

                console.log('백그라운드 데이터 미리 로드 완료');
            } catch (error) {
                console.error('백그라운드 데이터 미리 로드 오류:', error);
            }
        }

        // 각 섹션별 데이터 미리 로드
        async function preloadPostsData() {
            try {
                const [postsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/posts'),
                    fetch('/api/v1/stats/daily')
                ]);
                const posts = await postsResponse.json();
                const stats = await statsResponse.json();
                DataManager.setCachedData('posts', { posts, stats });
                console.log('포스트 데이터 미리 로드 완료');
            } catch (error) {
                console.error('포스트 데이터 미리 로드 오류:', error);
            }
        }

        async function preloadKeywordsData() {
            try {
                const [keywordsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/keywords'),
                    fetch('/api/v1/stats/keywords-summary')
                ]);
                const keywords = await keywordsResponse.json();
                const stats = await statsResponse.json();
                DataManager.setCachedData('keywords', { keywords, stats });
                console.log('키워드 데이터 미리 로드 완료');
            } catch (error) {
                console.error('키워드 데이터 미리 로드 오류:', error);
            }
        }

        async function preloadNewsData() {
            try {
                const [newsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/news-archive/'),
                    fetch('/api/v1/stats/dashboard')
                ]);
                const news = await newsResponse.json();
                const stats = await statsResponse.json();
                DataManager.setCachedData('news', { news, stats });
                console.log('뉴스 데이터 미리 로드 완료');
            } catch (error) {
                console.error('뉴스 데이터 미리 로드 오류:', error);
            }
        }

        async function preloadUpdatesData() {
            try {
                const response = await fetch('/api/v1/feature-updates/history');
                const updates = await response.json();
                DataManager.setCachedData('updates', updates);
                console.log('업데이트 이력 미리 로드 완료');
            } catch (error) {
                console.error('업데이트 이력 미리 로드 오류:', error);
            }
        }

        async function preloadSystemData() {
            try {
                const [uptimeResponse, dbSizeResponse, apiResponseTimeResponse, logFilesResponse] = await Promise.all([
                    fetch('/api/v1/system/uptime'),
                    fetch('/api/v1/system/db-size'),
                    fetch('/api/v1/system/api-response-time'),
                    fetch('/api/v1/system/log-files')
                ]);
                const uptime = await uptimeResponse.json();
                const dbSize = await dbSizeResponse.json();
                const apiResponseTime = await apiResponseTimeResponse.json();
                const logFiles = await logFilesResponse.json();
                DataManager.setCachedData('system', { uptime, dbSize, apiResponseTime, logFiles });
                console.log('시스템 데이터 미리 로드 완료');
            } catch (error) {
                console.error('시스템 데이터 미리 로드 오류:', error);
            }
        }

        // 관리자 초기화
        function initializeAdmin() {
            // 메뉴 클릭 이벤트 - onclick 속성 기반으로 처리
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault(); // 기본 링크 동작 방지

                    // onclick 속성에서 섹션 이름 추출
                    const onclickAttr = this.getAttribute('onclick');
                    if (onclickAttr) {
                        const match = onclickAttr.match(/showContent\('([^']+)'\)/);
                        if (match) {
                            const section = match[1];
                            console.log('메뉴 클릭 감지:', section);
                            showContent(section);
                        } else {
                            console.warn('onclick 속성에서 섹션을 추출할 수 없음:', onclickAttr);
                        }
                    } else {
                        console.warn('onclick 속성이 없는 메뉴:', this.textContent.trim());
                    }
                });
            });

            // 초기 대시보드 로드
            console.log('초기 대시보드 로드 시작');
            setTimeout(() => {
                showContent('dashboard');
            }, 100);
        }

        // 섹션 전환 (기존 함수 유지)
        function switchSection(section) {
            showContent(section);
        }

        // showContent 함수 (완전히 새로 작성)
        function showContent(section) {
            console.log('=== showContent 호출됨 ===', section);

            // 유효한 섹션인지 확인
            const validSections = ['dashboard', 'posts', 'keywords', 'news', 'updates', 'system', 'performance'];
            if (!validSections.includes(section)) {
                console.error('유효하지 않은 섹션:', section);
                return;
            }

            // 시스템 탭에서 다른 탭으로 이동하는 경우 실시간 업데이트 중지
            if (currentSection === 'system' && section !== 'system') {
                stopSystemRealTimeUpdate();
            }

            // 성능 모니터링 탭에서 다른 탭으로 이동하는 경우 실시간 업데이트 중지
            if (currentSection === 'performance' && section !== 'performance') {
                stopPerformanceRealTimeUpdate();
            }

            // 1. 현재 섹션 저장 (실시간 업데이트 추적용)
            currentSection = section;
            console.log('현재 섹션 변경:', currentSection);

            // 2. 모든 메뉴 비활성화
            const allNavLinks = document.querySelectorAll('.nav-link');
            allNavLinks.forEach(link => {
                link.classList.remove('active');
            });

            // 3. 클릭된 메뉴 활성화
            const activeNavLink = document.querySelector(`.nav-link[onclick*="showContent('${section}')"]`);
            if (activeNavLink) {
                activeNavLink.classList.add('active');
                console.log('메뉴 활성화됨:', section);
            } else {
                console.warn('활성화할 메뉴를 찾을 수 없음:', section);
            }

            // 4. 모든 콘텐츠 섹션 숨기기
            const allContentSections = document.querySelectorAll('.content-section');
            allContentSections.forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });

            // 5. 해당 콘텐츠 섹션 표시
            const targetContent = document.getElementById(`${section}-content`);
            if (targetContent) {
                targetContent.style.display = 'block';
                targetContent.classList.add('active');
                console.log('콘텐츠 섹션 표시됨:', section);

                // 6. 데이터 로드 (안전하게)
                try {
                    loadSectionDataDirect(section);
                } catch (error) {
                    console.error('데이터 로드 중 오류:', error);
                    showToast(`${section} 데이터 로드 중 오류가 발생했습니다.`, 'error');
                }
            } else {
                console.error('콘텐츠 섹션을 찾을 수 없음:', `${section}-content`);
                showToast(`${section} 콘텐츠를 찾을 수 없습니다.`, 'error');
            }
        }

        // 섹션별 데이터 로드 함수
        function loadSectionData(section) {
            console.log('loadSectionData 호출됨:', section);

            switch (section) {
                case 'dashboard':
                    console.log('대시보드 데이터 로드 시작');
                    loadDashboardData();
                    break;
                case 'posts':
                    console.log('포스트 데이터 로드 시작');
                    loadPostsData();
                    break;
                case 'keywords':
                    console.log('키워드 데이터 로드 시작');
                    loadKeywordsData();
                    break;
                case 'news':
                    console.log('뉴스 데이터 로드 시작');
                    loadNewsData();
                    break;
                case 'updates':
                    console.log('업데이트 이력 데이터 로드 시작');
                    loadUpdatesData();
                    break;
                case 'system':
                    console.log('시스템 데이터 로드 시작');
                    loadSystemData();
                    // 실시간 업데이트 시작
                    startSystemRealTimeUpdate();
                    break;
                case 'performance':
                    console.log('성능 모니터링 데이터 로드 시작');
                    loadPerformanceData();
                    // 실시간 업데이트 시작
                    startPerformanceRealTimeUpdate();
                    break;
                default:
                    console.warn('알 수 없는 섹션:', section);
            }
        }

        // 빠른 로딩 상태 표시 (짧은 시간만 표시)
        function showQuickLoadingState(section) {
            const targetContent = document.getElementById(`${section}-content`);
            if (targetContent) {
                const container = targetContent.querySelector('.content-body');
                if (container) {
                    // 기존 내용을 유지하면서 로딩 오버레이만 추가
                    const loadingOverlay = document.createElement('div');
                    loadingOverlay.className = 'loading-overlay';
                    loadingOverlay.innerHTML = '<div class="loading">데이터를 불러오는 중...</div>';
                    loadingOverlay.id = 'loading-overlay';
                    container.appendChild(loadingOverlay);

                    // 300ms 후 자동으로 로딩 상태 제거 (데이터 로드 완료 여부와 관계없이)
                    setTimeout(() => {
                        removeLoadingState(section);
                    }, 300);
                }
            }
        }

        // 로딩 상태 표시 (기존 함수 유지)
        function showLoadingState(section) {
            const targetContent = document.getElementById(`${section}-content`);
            if (targetContent) {
                const container = targetContent.querySelector('.content-body');
                if (container) {
                    container.innerHTML = '<div class="loading">데이터를 불러오는 중입니다...</div>';
                }
            }
        }

        // 로딩 상태 제거
        function removeLoadingState(section) {
            const targetContent = document.getElementById(`${section}-content`);
            if (targetContent) {
                const loadingElement = targetContent.querySelector('.loading');
                const loadingOverlay = targetContent.querySelector('#loading-overlay');
                if (loadingElement) {
                    loadingElement.remove();
                }
                if (loadingOverlay) {
                    loadingOverlay.remove();
                }
            }
        }

        // 시스템 실시간 업데이트 시작
        function startSystemRealTimeUpdate() {
            console.log('시스템 실시간 업데이트 시작');

            // 기존 인터벌이 있다면 제거
            if (window.systemUpdateInterval) {
                clearInterval(window.systemUpdateInterval);
            }

            // 30초마다 시스템 데이터 업데이트
            window.systemUpdateInterval = setInterval(() => {
                if (currentSection === 'system') {
                    console.log('시스템 실시간 업데이트 실행');
                    loadSystemData(true); // 강제 새로고침
                } else {
                    // 시스템 탭이 아닌 경우 인터벌 중지
                    stopSystemRealTimeUpdate();
                }
            }, 30000); // 30초마다
        }

        // 시스템 실시간 업데이트 중지
        function stopSystemRealTimeUpdate() {
            console.log('시스템 실시간 업데이트 중지');
            if (window.systemUpdateInterval) {
                clearInterval(window.systemUpdateInterval);
                window.systemUpdateInterval = null;
            }
        }

        // 시스템 데이터 새로고침 (수동)
        async function refreshSystemData() {
            console.log('시스템 데이터 수동 새로고침 시작');
            try {
                // 캐시 무효화
                window.cachedSystemData = null;

                // 강제 새로고침
                await loadSystemData(true);

                showToast('시스템 데이터가 새로고침되었습니다.', 'success');
            } catch (error) {
                console.error('시스템 데이터 새로고침 오류:', error);
                showToast('시스템 데이터 새로고침 중 오류가 발생했습니다.', 'error');
            }
        }

        // 현재 섹션 데이터 로드
        function loadCurrentSection() {
            console.log('loadCurrentSection 호출됨:', currentSection); // 디버깅용

            switch (currentSection) {
                case 'dashboard':
                    console.log('대시보드 데이터 로드 시작');
                    loadDashboardData();
                    break;
                case 'posts':
                    console.log('포스트 데이터 로드 시작');
                    loadPostsData();
                    break;
                case 'keywords':
                    console.log('키워드 데이터 로드 시작');
                    loadKeywordsData();
                    break;
                case 'news':
                    console.log('뉴스 데이터 로드 시작');
                    loadNewsData();
                    break;
                case 'updates':
                    console.log('업데이트 이력 데이터 로드 시작');
                    loadUpdatesData();
                    break;
                case 'system':
                    console.log('시스템 데이터 로드 시작');
                    loadSystemData();
                    // 실시간 업데이트 시작
                    startSystemRealTimeUpdate();
                    break;
                default:
                    console.warn('알 수 없는 섹션:', currentSection);
            }
        }

        // 성능 최적화된 데이터 로드 함수들
        async function loadDashboardData() {
            console.log('대시보드 데이터 로드 시작');

            try {
                const [postsResponse, keywordsResponse, statsResponse, updatesResponse] = await Promise.all([
                    fetch('/api/v1/posts'),
                    fetch('/api/v1/keywords'),
                    fetch('/api/v1/stats/dashboard'),
                    fetch('/api/v1/feature-updates/history')
                ]);

                const posts = await postsResponse.json();
                const keywords = await keywordsResponse.json();
                const stats = await statsResponse.json();
                const updates = await updatesResponse.json();

                console.log('대시보드 데이터 로드 완료:', { posts: posts.length, keywords: keywords.length, updates: updates.length });

                updateDashboardContainer(posts, keywords, stats);
                updateDashboardStats(stats);
                updateUpdateHistoryStats(updates);
                updateDetailedStats(updates);

            } catch (error) {
                console.error('대시보드 데이터 로드 오류:', error);
                showToast('대시보드 데이터를 불러오는데 실패했습니다.', 'error');
            }
        }

        async function loadPostsData() {
            console.log('포스트 데이터 로드 시작');

            try {
                const [postsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/posts'),
                    fetch('/api/v1/stats/daily')
                ]);

                const posts = await postsResponse.json();
                const stats = await statsResponse.json();

                console.log('포스트 데이터 로드 완료:', posts.length, '개 포스트');

                updatePostsContainer(posts);
                updatePostsStats(stats);

            } catch (error) {
                console.error('포스트 데이터 로드 오류:', error);
                showToast('포스트 데이터를 불러오는데 실패했습니다.', 'error');
            }
        }

        async function loadKeywordsData() {
            console.log('키워드 데이터 로드 시작');

            try {
                const [keywordsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/keywords'),
                    fetch('/api/v1/stats/keywords-summary')
                ]);

                const keywords = await keywordsResponse.json();
                const stats = await statsResponse.json();

                console.log('키워드 데이터 로드 완료:', keywords.length, '개 키워드');

                updateKeywordsContainer(keywords);
                updateKeywordsStats(stats);

            } catch (error) {
                console.error('키워드 데이터 로드 오류:', error);
                showToast('키워드 데이터를 불러오는데 실패했습니다.', 'error');
            }
        }

        async function loadNewsData() {
            console.log('뉴스 데이터 로드 시작');

            try {
                const [newsResponse, statsResponse] = await Promise.all([
                    fetch('/api/v1/news-archive/'),
                    fetch('/api/v1/stats/dashboard')
                ]);

                const news = await newsResponse.json();
                const stats = await statsResponse.json();

                console.log('뉴스 데이터 로드 완료:', news.length, '개 뉴스');

                updateNewsContainer(news);
                updateNewsStats(news);

            } catch (error) {
                console.error('뉴스 데이터 로드 오류:', error);
                showToast('뉴스 데이터를 불러오는데 실패했습니다.', 'error');
            }
        }

        async function loadUpdatesData() {
            const cacheKey = 'updates';

            console.log('=== loadUpdatesData 함수 시작 ===');

            if (DataManager.isLoading(cacheKey)) {
                console.log('업데이트 이력 로딩 중... 중복 요청 방지');
                return;
            }

            const cachedData = DataManager.getCachedData(cacheKey);
            if (cachedData) {
                console.log('캐시된 데이터 사용:', cachedData.length, '개');
                updateUpdatesContainer(cachedData);
                updateUpdatesStats(cachedData);
                updateUpdateHistoryStats(cachedData);
                updateDetailedStats(cachedData);

                // 강제 통계 업데이트
                forceUpdateStats(cachedData);
                return;
            }

            DataManager.setLoading(cacheKey, true);

            try {
                console.log('API에서 업데이트 이력 데이터 요청...');
                const response = await fetch('/api/v1/feature-updates/history');

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const updates = await response.json();
                console.log('API 응답 받음:', updates.length, '개 업데이트');
                DataManager.setCachedData(cacheKey, updates);

                updateUpdatesContainer(updates);
                updateUpdatesStats(updates);
                updateUpdateHistoryStats(updates);
                updateDetailedStats(updates);

                // 강제 통계 업데이트
                forceUpdateStats(updates);

                console.log('=== loadUpdatesData 함수 완료 ===');

            } catch (error) {
                console.error('업데이트 이력 로드 오류:', error);
                showToast('업데이트 이력을 불러오는데 실패했습니다.', 'error');
            } finally {
                DataManager.setLoading(cacheKey, false);
            }
        }

        async function loadSystemData() {
            const cacheKey = 'system';

            if (DataManager.isLoading(cacheKey)) {
                console.log('시스템 데이터 로딩 중... 중복 요청 방지');
                return;
            }

            const cachedData = DataManager.getCachedData(cacheKey);
            if (cachedData) {
                const { uptime, dbSize, apiResponseTime, logFiles } = cachedData;
                updateSystemOverview(uptime, dbSize, apiResponseTime, logFiles);
                updateSystemMonitoringCharts(uptime, dbSize, apiResponseTime);
                updateDatabaseTablesInfo(logFiles);
                updateApiUsageStats(logFiles);
                updateApiKeysStatus(logFiles);
                updateLogLevelChart(logFiles);
                return;
            }

            DataManager.setLoading(cacheKey, true);

            try {
                const [uptimeResponse, dbSizeResponse, apiResponseTimeResponse, logFilesResponse] = await Promise.all([
                    fetch('/api/v1/system/uptime'),
                    fetch('/api/v1/system/db-size'),
                    fetch('/api/v1/system/api-response-time'),
                    fetch('/api/v1/system/log-files')
                ]);

                const uptime = await uptimeResponse.json();
                const dbSize = await dbSizeResponse.json();
                const apiResponseTime = await apiResponseTimeResponse.json();
                const logFiles = await logFilesResponse.json();

                const data = { uptime, dbSize, apiResponseTime, logFiles };
                DataManager.setCachedData(cacheKey, data);

                updateSystemOverview(uptime, dbSize, apiResponseTime, logFiles);
                updateSystemMonitoringCharts(uptime, dbSize, apiResponseTime);
                updateDatabaseTablesInfo(logFiles);
                updateApiUsageStats(logFiles);
                updateApiKeysStatus(logFiles);
                updateLogLevelChart(logFiles);
                refreshLogs();

            } catch (error) {
                console.error('시스템 데이터 로드 오류:', error);
                showToast('시스템 데이터를 불러오는데 실패했습니다.', 'error');
            } finally {
                DataManager.setLoading(cacheKey, false);
            }
        }

        // 뉴스 수집
        async function collectNews() {
            try {
                document.getElementById('collection-status').style.display = 'block';

                const response = await fetch('/api/v1/news-archive/collect', {
                    method: 'POST'
                });
                const result = await response.json();

                if (result.success) {
                    showToast(`뉴스 수집 완료: ${result.total_collected}개 수집`, 'success');
                    loadNewsData(); // 뉴스 목록 새로고침
                } else {
                    showToast('뉴스 수집에 실패했습니다.', 'error');
                }

            } catch (error) {
                console.error('뉴스 수집 오류:', error);
                showToast('뉴스 수집 중 오류가 발생했습니다.', 'error');
            } finally {
                document.getElementById('collection-status').style.display = 'none';
            }
        }

        // 뉴스 새로고침
        function refreshNews() {
            // 캐시 무효화
            delete window.cachedNewsData;
            loadNewsData();
            showToast('뉴스 데이터가 새로고침되었습니다.', 'success');
        }

        // 뉴스 요약 보기
        async function viewNewsSummary(newsId) {
            try {
                const response = await fetch(`/api/v1/news-archive/${newsId}/summary`);
                const summary = await response.json();

                if (summary.error) {
                    showToast(summary.error, 'error');
                    return;
                }

                showNewsSummaryModal(summary);

            } catch (error) {
                console.error('뉴스 요약 조회 오류:', error);
                showToast('뉴스 요약을 불러오는데 실패했습니다.', 'error');
            }
        }

        // 뉴스 요약 모달 표시
        function showNewsSummaryModal(summary) {
            const modalHtml = `
                <div class="modal fade" id="newsSummaryModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">뉴스 요약 및 분석</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="news-summary-content">
                                    <h6>${summary.title}</h6>
                                    <p class="text-muted mb-3">
                                        <small>카테고리: ${summary.category} | 
                                        신뢰성: ${summary.trust_score}/10 (${summary.trust_level}) | 
                                        관련성: ${summary.relevance_score}/10 (${summary.relevance_level})</small>
                                    </p>
                                    
                                    <div class="mb-3">
                                        <strong>요약:</strong>
                                        <p>${summary.summary}</p>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <strong>원본 링크:</strong>
                                        <a href="${summary.url}" target="_blank" class="btn btn-sm btn-outline-primary">
                                            <i class="bi bi-box-arrow-up-right"></i> 새 창에서 보기
                                        </a>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="card">
                                                <div class="card-body text-center">
                                                    <h6>신뢰성 점수</h6>
                                                    <div class="display-4 text-primary">${summary.trust_score}/10</div>
                                                    <small class="text-muted">${summary.trust_level}</small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card">
                                                <div class="card-body text-center">
                                                    <h6>관련성 점수</h6>
                                                    <div class="display-4 text-success">${summary.relevance_score}/10</div>
                                                    <small class="text-muted">${summary.relevance_level}</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // 기존 모달 제거
            const existingModal = document.getElementById('newsSummaryModal');
            if (existingModal) {
                existingModal.remove();
            }

            // 새 모달 추가
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // 모달 표시
            const modal = new bootstrap.Modal(document.getElementById('newsSummaryModal'));
            modal.show();
        }

        // 뉴스 삭제
        async function deleteNews(newsId) {
            if (!confirm('이 뉴스를 삭제하시겠습니까?')) {
                return;
            }

            try {
                const response = await fetch(`/api/v1/news-archive/${newsId}`, {
                    method: 'DELETE'
                });
                const result = await response.json();

                if (result.success) {
                    showToast('뉴스가 삭제되었습니다.', 'success');
                    loadNewsData(); // 목록 새로고침
                } else {
                    showToast('뉴스 삭제에 실패했습니다.', 'error');
                }

            } catch (error) {
                console.error('뉴스 삭제 오류:', error);
                showToast('뉴스 삭제 중 오류가 발생했습니다.', 'error');
            }
        }

        // 업데이트 이력 데이터 로드
        async function loadUpdatesData() {
            console.log('loadUpdatesData 함수 시작'); // 디버깅용
            try {
                // 캐시된 데이터가 있는지 확인
                if (window.cachedUpdates) {
                    console.log('캐시된 업데이트 이력 사용');
                    updateUpdatesContainer(window.cachedUpdates);
                    updateUpdatesStats(window.cachedUpdates);
                    return;
                }

                const response = await fetch('/api/v1/feature-updates/history', {
                    headers: {
                        'Cache-Control': 'max-age=300' // 5분 캐시
                    }
                });
                console.log('업데이트 이력 API 응답 상태:', response.status); // 디버깅용

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const updates = await response.json();
                console.log('업데이트 이력 데이터 로드 완료:', updates.length, '개 항목'); // 디버깅용

                // 데이터 캐시
                window.cachedUpdates = updates;

                updateUpdatesContainer(updates);
                updateUpdatesStats(updates); // 통계 업데이트

            } catch (error) {
                console.error('업데이트 이력 로드 오류:', error);
                showToast('업데이트 이력을 불러오는데 실패했습니다.', 'error');
                // 오류 시 로딩 상태 제거
                removeLoadingState('updates');
            }
        }

        // 시스템 데이터 로드 (실시간 업데이트 개선)
        async function loadSystemData(forceRefresh = false) {
            console.log('loadSystemData 함수 시작 (forceRefresh:', forceRefresh, ')'); // 디버깅용
            try {
                // 강제 새로고침이 아닌 경우에만 캐시 확인
                if (!forceRefresh && window.cachedSystemData) {
                    console.log('캐시된 시스템 데이터 사용');
                    const { uptime, dbSize, apiResponseTime, logFiles } = window.cachedSystemData;
                    updateSystemOverview(uptime, dbSize, apiResponseTime, logFiles);
                    updateSystemMonitoringCharts(uptime, dbSize, apiResponseTime);
                    updateDatabaseTablesInfo(logFiles);
                    updateApiUsageStats(logFiles);
                    updateApiKeysStatus(logFiles);
                    updateLogLevelChart(logFiles);
                    return;
                }

                console.log('실시간 시스템 데이터 로드 중...');

                const [uptimeResponse, dbSizeResponse, apiResponseTimeResponse, logFilesResponse] = await Promise.all([
                    fetch('/api/v1/system/uptime'),
                    fetch('/api/v1/system/db-size'),
                    fetch('/api/v1/system/api-response-time'),
                    fetch('/api/v1/system/log-files')
                ]);

                console.log('시스템 API 응답 상태들:', {
                    uptime: uptimeResponse.status,
                    dbSize: dbSizeResponse.status,
                    apiResponseTime: apiResponseTimeResponse.status,
                    logFiles: logFilesResponse.status
                }); // 디버깅용

                const uptime = await uptimeResponse.json();
                const dbSize = await dbSizeResponse.json();
                const apiResponseTime = await apiResponseTimeResponse.json();
                const logFiles = await logFilesResponse.json();

                console.log('시스템 데이터 로드 완료:', {
                    uptime: uptime.uptime,
                    dbSize: dbSize.size,
                    apiResponseTime: apiResponseTime.average_response_time,
                    logFiles: logFiles.total_files
                }); // 디버깅용

                // 데이터 캐시 (최신 데이터로 업데이트)
                window.cachedSystemData = { uptime, dbSize, apiResponseTime, logFiles };

                updateSystemOverview(uptime, dbSize, apiResponseTime, logFiles);
                updateSystemMonitoringCharts(uptime, dbSize, apiResponseTime);
                updateDatabaseTablesInfo(logFiles);
                updateApiUsageStats(logFiles);
                updateApiKeysStatus(logFiles);
                updateLogLevelChart(logFiles);
                refreshLogs(); // 실시간 로그 로드

                // 실시간 업데이트 시작 (시스템 탭이 활성화된 경우에만)
                if (currentSection === 'system' && !window.systemUpdateInterval) {
                    startSystemRealTimeUpdate();
                }

                // 성능 모니터링 데이터 로드
                await loadPerformanceMonitoringData();
            } catch (error) {
                console.error('시스템 데이터 로드 오류:', error);
                showToast('시스템 데이터를 불러오는데 실패했습니다.', 'error');
                // 오류 시 로딩 상태 제거
                removeLoadingState('system');
            }
        }

        // 컨테이너 업데이트 함수들
        function updateDashboardContainer(posts, keywords, stats) {
            console.log('updateDashboardContainer 호출됨:', { posts: posts?.length, keywords: keywords?.length, stats });

            try {
                // 실제 데이터로 통계 계산 (stats가 없거나 부정확한 경우)
                const actualTotalPosts = posts ? posts.length : 0;
                const actualTotalKeywords = keywords ? keywords.length : 0;

                // stats에서 가져오거나 실제 데이터 사용
                const totalPosts = stats?.total_posts || actualTotalPosts;
                const totalKeywords = stats?.total_keywords || actualTotalKeywords;
                const apiCallsToday = stats?.api_calls_today || 0;
                const crawlSuccessRate = stats?.crawl_success_rate || 0;

                // 대시보드 통계 업데이트
                const elements = {
                    'total-posts': totalPosts,
                    'total-keywords': totalKeywords,
                    'api-calls-today': apiCallsToday,
                    'crawl-success-rate': `${crawlSuccessRate}%`
                };

                console.log('대시보드 통계 업데이트:', elements);

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                        console.log(`✅ 대시보드 요소 업데이트: ${id} = ${value}`);
                    } else {
                        console.warn(`❌ 대시보드 요소를 찾을 수 없습니다: ${id}`);
                    }
                });

                console.log('대시보드 컨테이너 업데이트 완료');
            } catch (error) {
                console.error('대시보드 컨테이너 업데이트 오류:', error);
            }
        }

        function updatePostsContainer(posts) {
            console.log('updatePostsContainer 호출됨:', posts);
            const container = document.getElementById('posts-table-body');
            if (!container) {
                console.error('posts-table-body 요소를 찾을 수 없습니다.');
                return;
            }

            if (!posts || posts.length === 0) {
                container.innerHTML = '<tr><td colspan="7" class="text-center text-muted py-4">포스트가 없습니다.</td></tr>';
                return;
            }

            let html = '';

            posts.forEach(post => {
                const title = post.title || '제목 없음';
                const url = post.original_url || '직접 입력';
                const keywords = post.keywords || 'N/A';
                const wordCount = post.word_count || 0;
                const createdDate = new Date(post.created_at).toLocaleDateString('ko-KR');

                html += `
                    <tr>
                        <td>
                            <div class="fw-bold" title="${title}">${title}</div>
                            <small class="text-muted" title="${url}">${url}</small>
                        </td>
                        <td><span class="badge bg-primary" title="${keywords}">${keywords}</span></td>
                        <td><span class="text-nowrap">${wordCount}자</span></td>
                        <td><span class="text-nowrap">${createdDate}</span></td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-modern btn-primary-modern" onclick="viewPost(${post.id})" title="보기">
                                    <i class="bi bi-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-modern btn-danger-modern" onclick="deletePost(${post.id})" title="삭제">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            container.innerHTML = html;
            console.log('포스트 컨테이너 업데이트 완료');
        }

        function updateKeywordsContainer(keywords) {
            console.log('updateKeywordsContainer 호출됨:', keywords);
            const container = document.getElementById('keywords-table-body');
            if (!container) {
                console.error('keywords-table-body 요소를 찾을 수 없습니다.');
                return;
            }

            if (!keywords || keywords.length === 0) {
                container.innerHTML = '<tr><td colspan="8" class="text-center text-muted py-4">키워드가 없습니다.</td></tr>';
                return;
            }

            let html = '';

            keywords.forEach(keyword => {
                const keywordText = keyword.keyword || '키워드 없음';
                const category = keyword.type || 'N/A';
                const createdDate = new Date(keyword.created_at).toLocaleDateString('ko-KR');

                html += `
                    <tr>
                        <td><span class="fw-bold" title="${keywordText}">${keywordText}</span></td>
                        <td><span class="badge bg-secondary" title="${category}">${category}</span></td>
                        <td><span class="text-nowrap">${createdDate}</span></td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-modern btn-danger-modern" onclick="deleteKeyword(${keyword.id})" title="삭제">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            container.innerHTML = html;
            console.log('키워드 컨테이너 업데이트 완료');
        }

        function updateNewsContainer(news) {
            console.log('updateNewsContainer 호출됨:', news);
            const container = document.getElementById('news-container');
            if (!container) {
                console.error('news-container 요소를 찾을 수 없습니다.');
                return;
            }

            if (!news || news.length === 0) {
                container.innerHTML = '<div class="text-center text-muted py-4">수집된 뉴스가 없습니다.</div>';
                return;
            }

            let html = '<div class="table-responsive"><table class="table table-hover"><thead><tr><th>제목</th><th>카테고리</th><th>신뢰성</th><th>관련성</th><th>수집일</th><th>작업</th></tr></thead><tbody>';

            news.forEach(item => {
                const title = item.title || '제목 없음';
                const source = item.source || 'N/A';
                const category = item.category || 'N/A';
                const trustLevel = getTrustLevel(item.trust_score);
                const relevanceLevel = getRelevanceLevel(item.relevance_score);
                const collectedDate = new Date(item.collected_at).toLocaleDateString('ko-KR');

                html += `
                    <tr>
                        <td>
                            <div class="fw-bold" title="${title}">${title}</div>
                            <small class="text-muted" title="${source}">${source}</small>
                        </td>
                        <td><span class="badge bg-primary" title="${category}">${category}</span></td>
                        <td>
                            <span class="badge ${trustLevel.badge}" title="${trustLevel.text}">${item.trust_score || 0}/10</span>
                            <small class="text-muted d-block">${trustLevel.text}</small>
                        </td>
                        <td>
                            <span class="badge ${relevanceLevel.badge}" title="${relevanceLevel.text}">${item.relevance_score || 0}/10</span>
                            <small class="text-muted d-block">${relevanceLevel.text}</small>
                        </td>
                        <td><span class="text-nowrap">${collectedDate}</span></td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-modern btn-primary-modern" onclick="viewNews(${item.id})" title="보기">
                                    <i class="bi bi-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-modern btn-secondary-modern" onclick="openNewsUrl('${item.url}')" title="링크 열기">
                                    <i class="bi bi-box-arrow-up-right"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table></div>';
            container.innerHTML = html;
            console.log('뉴스 컨테이너 업데이트 완료');
        }

        function updateUpdatesContainer(updates) {
            console.log('updateUpdatesContainer 함수 시작:', updates.length, '개 업데이트'); // 디버깅용
            const container = document.getElementById('updates-container');

            if (!container) {
                console.error('updates-container 요소를 찾을 수 없습니다.');
                return;
            }

            if (updates.length === 0) {
                container.innerHTML = '<div class="text-center text-muted py-4">업데이트 이력이 없습니다.</div>';
                return;
            }

            try {
                // 날짜별로 그룹화
                const groupedUpdates = groupUpdatesByDate(updates);
                let html = '';

                Object.keys(groupedUpdates).sort().reverse().forEach(date => {
                    html += `<div class="mb-4"><h5 class="text-primary mb-3">${date}</h5>`;

                    groupedUpdates[date].forEach(update => {
                        html += `
                            <div class="update-card">
                                <div class="card-body">
                                    <h6 class="card-title">${update.title || '업데이트'}</h6>
                                    <p class="card-text">${update.description || update.content}</p>
                                    <small class="text-muted">${update.type || '일반'}</small>
                                </div>
                            </div>
                        `;
                    });

                    html += '</div>';
                });

                container.innerHTML = html;
                console.log('업데이트 이력 컨테이너 업데이트 완료'); // 디버깅용

                // 로딩 상태 제거
                removeLoadingState('updates');
            } catch (error) {
                console.error('업데이트 이력 컨테이너 업데이트 오류:', error);
                container.innerHTML = '<div class="text-center text-danger py-4">업데이트 이력을 표시하는 중 오류가 발생했습니다.</div>';
                // 오류 시에도 로딩 상태 제거
                removeLoadingState('updates');
            }
        }

        // 날짜별로 업데이트 그룹화
        function groupUpdatesByDate(updates) {
            const grouped = {};

            updates.forEach(update => {
                let dateStr = update.created_at || update.date;

                // "YYYY.MM.DD" 형식을 "YYYY-MM-DD" 형식으로 변환
                if (dateStr && typeof dateStr === 'string' && dateStr.includes('.')) {
                    dateStr = dateStr.replace(/\./g, '-');
                }

                let date;
                try {
                    date = new Date(dateStr);
                    if (isNaN(date.getTime())) {
                        // 날짜 파싱 실패 시 원본 문자열 사용
                        date = dateStr;
                    } else {
                        date = date.toLocaleDateString('ko-KR');
                    }
                } catch (error) {
                    console.warn('날짜 파싱 오류:', dateStr, error);
                    date = dateStr || '날짜 없음';
                }

                if (!grouped[date]) {
                    grouped[date] = [];
                }
                grouped[date].push(update);
            });

            return grouped;
        }

        // 통계 업데이트 함수들
        function updateDashboardStats(stats) {
            console.log('updateDashboardStats 호출됨:', stats);
            // 대시보드 통계 업데이트
            if (stats) {
                const elements = {
                    'total-posts': stats.total_posts || 0,
                    'total-keywords': stats.total_keywords || 0,
                    'api-calls-today': stats.api_calls_today || 0,
                    'crawl-success-rate': stats.crawl_success_rate || 0
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    } else {
                        console.warn(`요소를 찾을 수 없습니다: ${id}`);
                    }
                });
            }
        }

        function updatePostsStats(stats) {
            console.log('updatePostsStats 호출됨:', stats);
            // 포스트 통계 업데이트
            if (stats) {
                const elements = {
                    'total-posts': stats.total_posts || 0,
                    'today-posts': stats.today_posts || 0,
                    'avg-length': stats.avg_length || 0,
                    'total-keywords': stats.total_keywords || 0
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    } else {
                        console.warn(`요소를 찾을 수 없습니다: ${id}`);
                    }
                });
            }
        }

        function updateKeywordsStats(stats) {
            console.log('updateKeywordsStats 호출됨:', stats);
            // 키워드 통계 업데이트
            if (stats) {
                const elements = {
                    'total-keywords-count': stats.total_keywords || 0,
                    'ai-keywords': stats.ai_keywords || 0,
                    'seo-keywords': stats.seo_keywords || 0,
                    'tech-keywords': stats.tech_keywords || 0
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    } else {
                        console.warn(`요소를 찾을 수 없습니다: ${id}`);
                    }
                });
            }
        }

        function updateNewsStats(news) {
            console.log('updateNewsStats 호출됨:', news);
            // 뉴스 통계 업데이트
            if (news && Array.isArray(news)) {
                const total = news.length;
                const aeo = news.filter(item => item.category === 'AEO').length;
                const geo = news.filter(item => item.category === 'GEO').length;
                const aio = news.filter(item => item.category === 'AIO').length;

                const elements = {
                    'total-news': total,
                    'aeo-news-count': aeo,
                    'geo-news-count': geo,
                    'aio-news-count': aio
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    } else {
                        console.warn(`요소를 찾을 수 없습니다: ${id}`);
                    }
                });
            }
        }

        // 업데이트 이력 통계 업데이트 (비활성화)
        function updateUpdateHistoryStats(updates) {
            // 통계 카드가 숨겨져 있으므로 업데이트하지 않음
            console.log('통계 카드가 숨겨져 있어 업데이트 이력 통계를 건너뜁니다.');
            return;
        }

        // 강제 통계 업데이트 함수 (비활성화)
        function forceUpdateStats(updates) {
            // 통계 카드가 숨겨져 있으므로 업데이트하지 않음
            console.log('통계 카드가 숨겨져 있어 업데이트를 건너뜁니다.');
            return;
        }

        function updateDetailedStats(updates) {
            console.log('updateDetailedStats 호출됨:', updates.length, '개 업데이트');

            if (updates && Array.isArray(updates)) {
                // 중요도별 통계
                const highImportance = updates.filter(update => update.importance === '높음').length;
                const mediumImportance = updates.filter(update => update.importance === '보통').length;
                const lowImportance = updates.filter(update => update.importance === '낮음').length;

                // 영향도별 통계
                const newFeatures = updates.filter(update => update.impact_level === '신규 기능').length;
                const improvements = updates.filter(update => update.impact_level === '기능 개선').length;
                const bugfixes = updates.filter(update => update.impact_level === '버그 수정').length;

                // 성능 지표 계산
                const completed = updates.filter(update => update.development_phase === '완료').length;
                const completionRate = updates.length > 0 ? ((completed / updates.length) * 100).toFixed(1) : 0;

                const importanceScores = { '높음': 3, '보통': 2, '낮음': 1 };
                const totalScore = updates.reduce((sum, update) => sum + (importanceScores[update.importance] || 1), 0);
                const avgImportance = updates.length > 0 ? (totalScore / updates.length).toFixed(1) : 0;

                const elements = {
                    'high-importance': highImportance,
                    'medium-importance': mediumImportance,
                    'low-importance': lowImportance,
                    'new-features': newFeatures,
                    'improvements': improvements,
                    'bugfixes': bugfixes,
                    'completion-rate': completionRate + '%',
                    'avg-importance': avgImportance,
                    'dev-efficiency': '높음' // 기본값
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    } else {
                        console.warn(`상세 통계 요소를 찾을 수 없습니다: ${id}`);
                    }
                });

                console.log('상세 통계 업데이트 완료:', elements);
            }
        }

        function updateUpdatesStats(updates) {
            const total = updates.length;
            const uiux = updates.filter(update => update.type === 'UI/UX').length;
            const feature = updates.filter(update => update.type === '기능').length;
            const bugfix = updates.filter(update => update.type === '버그수정').length;
            const other = updates.filter(update => !['UI/UX', '기능', '버그수정'].includes(update.type)).length;

            // 업데이트 이력 통계 요소들이 있다면 업데이트
            const totalElement = document.getElementById('total-updates');
            const uiuxElement = document.getElementById('uiux-updates');
            const featureElement = document.getElementById('feature-updates');
            const bugfixElement = document.getElementById('bugfix-updates');

            if (totalElement) totalElement.textContent = total;
            if (uiuxElement) uiuxElement.textContent = uiux;
            if (featureElement) featureElement.textContent = feature;
            if (bugfixElement) bugfixElement.textContent = bugfix;
        }

        function getTrustLevel(score) {
            if (score >= 8.0) {
                return { badge: 'bg-success', text: '매우 높음' };
            } else if (score >= 6.0) {
                return { badge: 'bg-primary', text: '높음' };
            } else if (score >= 4.0) {
                return { badge: 'bg-warning', text: '보통' };
            } else {
                return { badge: 'bg-danger', text: '낮음' };
            }
        }

        function getRelevanceLevel(score) {
            if (score >= 8.0) {
                return { badge: 'bg-success', text: '매우 높음' };
            } else if (score >= 6.0) {
                return { badge: 'bg-primary', text: '높음' };
            } else if (score >= 4.0) {
                return { badge: 'bg-warning', text: '보통' };
            } else {
                return { badge: 'bg-danger', text: '낮음' };
            }
        }

        // 검색 및 필터 기능
        function setupSearchAndFilter() {
            // 포스트 검색
            const postSearch = document.getElementById('post-search');
            if (postSearch) {
                postSearch.addEventListener('input', function () {
                    filterPosts(this.value);
                });
            }

            // 키워드 검색
            const keywordSearch = document.getElementById('keyword-search');
            if (keywordSearch) {
                keywordSearch.addEventListener('input', function () {
                    filterKeywords(this.value);
                });
            }

            // 뉴스 검색
            const newsSearch = document.getElementById('news-search');
            if (newsSearch) {
                newsSearch.addEventListener('input', function () {
                    filterNews(this.value);
                });
            }

            // 업데이트 검색
            const updatesSearch = document.getElementById('updates-search');
            if (updatesSearch) {
                updatesSearch.addEventListener('input', function () {
                    filterUpdates(this.value);
                });
            }

            // 필터 변경 이벤트
            const filters = ['post-filter', 'keyword-filter', 'news-filter', 'updates-filter'];
            filters.forEach(filterId => {
                const filter = document.getElementById(filterId);
                if (filter) {
                    filter.addEventListener('change', function () {
                        applyFilter(this.id, this.value);
                    });
                }
            });
        }

        // 필터링 함수들
        function filterPosts(searchTerm) {
            const rows = document.querySelectorAll('#posts-table-body tr');
            rows.forEach(row => {
                const title = row.querySelector('td:first-child').textContent.toLowerCase();
                const visible = title.includes(searchTerm.toLowerCase());
                row.style.display = visible ? '' : 'none';
            });
        }

        function filterKeywords(searchTerm) {
            const rows = document.querySelectorAll('#keywords-table-body tr');
            rows.forEach(row => {
                const keyword = row.querySelector('td:first-child').textContent.toLowerCase();
                const visible = keyword.includes(searchTerm.toLowerCase());
                row.style.display = visible ? '' : 'none';
            });
        }

        function filterNews(searchTerm) {
            const rows = document.querySelectorAll('#news-container tbody tr');
            rows.forEach(row => {
                const title = row.querySelector('td:first-child').textContent.toLowerCase();
                const visible = title.includes(searchTerm.toLowerCase());
                row.style.display = visible ? '' : 'none';
            });
        }

        function filterUpdates(searchTerm) {
            const cards = document.querySelectorAll('#updates-container .update-card');
            cards.forEach(card => {
                const title = card.querySelector('.card-title').textContent.toLowerCase();
                const description = card.querySelector('.card-text').textContent.toLowerCase();
                const visible = title.includes(searchTerm.toLowerCase()) ||
                    description.includes(searchTerm.toLowerCase());
                card.style.display = visible ? '' : 'none';
            });
        }

        function applyFilter(filterId, filterValue) {
            switch (filterId) {
                case 'post-filter':
                    filterPostsByDate(filterValue);
                    break;
                case 'keyword-filter':
                    filterKeywordsByType(filterValue);
                    break;
                case 'news-filter':
                    filterNewsByCategory(filterValue);
                    break;
                case 'updates-filter':
                    filterUpdatesByType(filterValue);
                    break;
            }
        }

        function filterPostsByDate(filterValue) {
            const rows = document.querySelectorAll('#posts-table-body tr');
            const today = new Date();

            rows.forEach(row => {
                const dateCell = row.querySelector('td:nth-child(4)');
                const postDate = new Date(dateCell.textContent);
                let visible = true;

                switch (filterValue) {
                    case 'today':
                        visible = postDate.toDateString() === today.toDateString();
                        break;
                    case 'week':
                        const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                        visible = postDate >= weekAgo;
                        break;
                    case 'month':
                        const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
                        visible = postDate >= monthAgo;
                        break;
                }

                row.style.display = visible ? '' : 'none';
            });
        }

        function filterKeywordsByType(filterValue) {
            const rows = document.querySelectorAll('#keywords-table-body tr');
            rows.forEach(row => {
                const type = row.querySelector('td:nth-child(2)').textContent;
                const visible = !filterValue || type.includes(filterValue);
                row.style.display = visible ? '' : 'none';
            });
        }

        function filterNewsByCategory(filterValue) {
            const rows = document.querySelectorAll('#news-container tbody tr');
            rows.forEach(row => {
                const category = row.querySelector('td:nth-child(2)').textContent;
                const visible = !filterValue || category.includes(filterValue);
                row.style.display = visible ? '' : 'none';
            });
        }

        function filterUpdatesByType(filterValue) {
            const cards = document.querySelectorAll('#updates-container .update-card');
            cards.forEach(card => {
                const type = card.querySelector('.text-muted').textContent;
                const visible = !filterValue || type.includes(filterValue);
                card.style.display = visible ? '' : 'none';
            });
        }

        // 새로고침 함수들
        function refreshPosts() {
            DataManager.invalidateCache('posts');
            loadPostsData();
            showToast('포스트 데이터가 새로고침되었습니다.', 'success');
        }

        function refreshKeywords() {
            DataManager.invalidateCache('keywords');
            loadKeywordsData();
            showToast('키워드 데이터가 새로고침되었습니다.', 'success');
        }

        function refreshNews() {
            DataManager.invalidateCache('news');
            loadNewsData();
            showToast('뉴스 데이터가 새로고침되었습니다.', 'success');
        }

        async function refreshUpdates() {
            console.log('=== 업데이트 이력 새로고침 시작 ===');
            DataManager.invalidateCache('updates');

            try {
                const response = await fetch('/api/v1/feature-updates/history');
                const updatesData = await response.json();
                console.log('새로고침된 업데이트 데이터:', updatesData.length, '개');

                // 모든 업데이트 함수 호출
                updateUpdatesContainer(updatesData);
                updateUpdatesStats(updatesData);
                updateUpdateHistoryStats(updatesData);
                updateDetailedStats(updatesData);

                // 강제 통계 업데이트
                forceUpdateStats(updatesData);

                // 지연 후 한 번 더 강제 업데이트
                setTimeout(() => {
                    console.log('새로고침 후 지연 강제 업데이트');
                    forceUpdateStats(updatesData);
                }, 300);

                showToast('업데이트 이력이 새로고침되었습니다.', 'success');
                console.log('=== 업데이트 이력 새로고침 완료 ===');
            } catch (error) {
                console.error('업데이트 이력 새로고침 오류:', error);
                showToast('업데이트 이력 새로고침 중 오류가 발생했습니다.', 'error');
            }
        }

        function refreshSystem() {
            DataManager.invalidateCache('system');
            loadSystemData();
            showToast('시스템 데이터가 새로고침되었습니다.', 'success');
        }

        // 전체 캐시 무효화
        function clearAllCache() {
            DataManager.invalidateCache();
            console.log('모든 캐시가 무효화되었습니다.');
        }

        // 토스트 알림 (기존 함수를 새로운 함수로 리다이렉트)
        function showToast(message, type = 'info') {
            showModernToast(message, type);
        }

        // 액션 함수들
        async function viewPost(id) {
            try {
                // 로딩 상태 표시
                document.getElementById('modal-post-content').innerHTML =
                    '<div class="text-center text-muted py-4"><i class="bi bi-hourglass-split"></i> 로딩 중...</div>';

                // 모달 표시
                const modal = new bootstrap.Modal(document.getElementById('postDetailModal'));
                modal.show();

                // 포스트 데이터 가져오기
                const response = await fetch(`/api/v1/posts/${id}`);
                if (!response.ok) {
                    throw new Error(`포스트를 가져올 수 없습니다: ${response.status}`);
                }

                const post = await response.json();

                // 모달 내용 업데이트
                updatePostModal(post);

            } catch (error) {
                console.error('포스트 상세보기 오류:', error);
                document.getElementById('modal-post-content').innerHTML =
                    '<div class="text-center text-danger py-4"><i class="bi bi-exclamation-triangle"></i> 포스트를 불러올 수 없습니다.</div>';
            }
        }

        function updatePostModal(post) {
            // 포스트 메타데이터 업데이트
            document.getElementById('modal-post-title').textContent = post.title || '제목 없음';
            document.getElementById('modal-post-keywords').textContent = post.keywords || 'N/A';
            document.getElementById('modal-post-word-count').textContent = `${post.word_count || 0}자`;
            document.getElementById('modal-post-created').textContent = new Date(post.created_at).toLocaleDateString('ko-KR');
            document.getElementById('modal-post-url').textContent = post.original_url || '직접 입력';

            // 포스트 내용 업데이트
            const contentElement = document.getElementById('modal-post-content');
            if (post.content) {
                // 줄바꿈을 <br> 태그로 변환하고, HTML 태그는 이스케이프
                let content = post.content
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;')
                    .replace(/\n/g, '<br>')
                    .replace(/\r\n/g, '<br>');

                contentElement.innerHTML = `<div class="post-content-text">${content}</div>`;
            } else {
                contentElement.innerHTML = '<div class="text-center text-muted py-4">포스트 내용이 없습니다.</div>';
            }

            // SEO 분석 결과 업데이트
            updateSEOAnalysis(post.seo_analysis);
        }

        function updateSEOAnalysis(seoAnalysis) {
            const seoElement = document.getElementById('modal-seo-analysis');

            if (!seoAnalysis) {
                seoElement.innerHTML = '<div class="text-center text-muted py-2"><i class="bi bi-info-circle"></i> SEO 분석 정보가 없습니다.</div>';
                return;
            }

            const overallScore = seoAnalysis.overall_score || 0;
            const scoreClass = overallScore >= 80 ? 'excellent' :
                overallScore >= 60 ? 'good' :
                    overallScore >= 40 ? 'fair' : 'poor';

            let seoHtml = `
                <div class="mb-3">
                    <strong>종합 점수:</strong> 
                    <span class="seo-score ${scoreClass}">${overallScore}/100</span>
                </div>
            `;

            if (seoAnalysis.content_structure_score !== undefined) {
                seoHtml += `<div class="mb-2"><small>콘텐츠 구조: ${seoAnalysis.content_structure_score}/100</small></div>`;
            }
            if (seoAnalysis.eeat_score !== undefined) {
                seoHtml += `<div class="mb-2"><small>EEAT 평가: ${seoAnalysis.eeat_score}/100</small></div>`;
            }
            if (seoAnalysis.geo_optimization_score !== undefined) {
                seoHtml += `<div class="mb-2"><small>GEO 최적화: ${seoAnalysis.geo_optimization_score}/100</small></div>`;
            }

            seoElement.innerHTML = seoHtml;
        }

        function copyPostContent() {
            const contentElement = document.getElementById('modal-post-content');
            const content = contentElement.textContent || contentElement.innerText;

            navigator.clipboard.writeText(content).then(() => {
                showToast('포스트 내용이 클립보드에 복사되었습니다.', 'success');
            }).catch(() => {
                showToast('복사에 실패했습니다.', 'error');
            });
        }

        function downloadPostContent() {
            const title = document.getElementById('modal-post-title').textContent;
            const content = document.getElementById('modal-post-content').textContent ||
                document.getElementById('modal-post-content').innerText;

            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${title}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showToast('포스트 내용이 다운로드되었습니다.', 'success');
        }

        // 모달 닫기 시 스크롤 복원
        document.addEventListener('DOMContentLoaded', function () {
            const postDetailModal = document.getElementById('postDetailModal');
            if (postDetailModal) {
                postDetailModal.addEventListener('hidden.bs.modal', function () {
                    // body 스타일 복원
                    document.body.style.overflow = '';
                    document.body.style.paddingRight = '';
                    document.body.classList.remove('modal-open');

                    // 모달 백드롭 제거
                    const backdrops = document.querySelectorAll('.modal-backdrop');
                    backdrops.forEach(backdrop => backdrop.remove());

                    // 스크롤 위치 복원
                    setTimeout(() => {
                        window.scrollTo(0, window.scrollY);
                    }, 150);
                });

                // 모달 열기 시 스크롤 위치 저장
                postDetailModal.addEventListener('show.bs.modal', function () {
                    window.modalScrollPosition = window.scrollY;
                });
            }
        });

        async function deletePost(id) {
            if (!confirm('정말로 이 포스트를 삭제하시겠습니까?')) {
                return;
            }

            try {
                const response = await fetch(`/api/v1/posts/${id}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showToast('포스트가 성공적으로 삭제되었습니다.', 'success');
                    loadPostsData(); // 포스트 목록 새로고침
                } else {
                    const error = await response.json();
                    showToast(`포스트 삭제 실패: ${error.detail}`, 'error');
                }
            } catch (error) {
                console.error('포스트 삭제 오류:', error);
                showToast('포스트 삭제 중 오류가 발생했습니다.', 'error');
            }
        }

        function addKeyword() {
            const keyword = prompt('새 키워드를 입력하세요:');
            if (keyword) {
                showToast(`키워드 "${keyword}" 추가`, 'success');
            }
        }

        async function deleteKeyword(id) {
            if (!confirm('정말로 이 키워드를 삭제하시겠습니까?')) {
                return;
            }

            try {
                const response = await fetch(`/api/v1/keywords/${id}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showToast('키워드가 성공적으로 삭제되었습니다.', 'success');
                    loadKeywordsData(); // 키워드 목록 새로고침
                } else {
                    const error = await response.json();
                    showToast(`키워드 삭제 실패: ${error.detail}`, 'error');
                }
            } catch (error) {
                console.error('키워드 삭제 오류:', error);
                showToast('키워드 삭제 중 오류가 발생했습니다.', 'error');
            }
        }

        function collectNews() {
            showToast('뉴스 수집을 시작합니다...', 'info');
        }

        function viewNews(id) {
            showToast(`뉴스 ${id} 상세보기`, 'info');
        }

        function deleteNews(id) {
            if (confirm('정말로 이 뉴스를 삭제하시겠습니까?')) {
                showToast(`뉴스 ${id} 삭제`, 'success');
            }
        }

        // 시스템 개요 업데이트 (실시간 개선)
        function updateSystemOverview(uptime, dbSize, apiResponseTime, logFiles) {
            console.log('updateSystemOverview 함수 시작'); // 디버깅용
            try {
                const uptimeElement = document.getElementById('system-uptime');
                const dbSizeElement = document.getElementById('db-size');
                const apiResponseTimeElement = document.getElementById('api-response-time');
                const logFilesElement = document.getElementById('log-files-count');

                // 이전 값과 비교하여 변경된 경우에만 업데이트
                if (uptimeElement) {
                    const newUptime = uptime.uptime || 'N/A';
                    if (uptimeElement.textContent !== newUptime) {
                        uptimeElement.textContent = newUptime;
                        console.log('시스템 가동시간 업데이트:', newUptime);
                    }
                }

                if (dbSizeElement) {
                    const newDbSize = dbSize.size || 'N/A';
                    if (dbSizeElement.textContent !== newDbSize) {
                        dbSizeElement.textContent = newDbSize;
                        console.log('데이터베이스 크기 업데이트:', newDbSize);
                    }
                }

                if (apiResponseTimeElement) {
                    const newResponseTime = apiResponseTime.average_response_time || 'N/A';
                    if (apiResponseTimeElement.textContent !== newResponseTime) {
                        apiResponseTimeElement.textContent = newResponseTime;
                        console.log('API 응답시간 업데이트:', newResponseTime);
                    }
                }

                if (logFilesElement) {
                    const newLogFiles = logFiles.total_files || 'N/A';
                    if (logFilesElement.textContent !== newLogFiles) {
                        logFilesElement.textContent = newLogFiles;
                        console.log('로그 파일 수 업데이트:', newLogFiles);
                    }
                }

                console.log('시스템 개요 업데이트 완료'); // 디버깅용

                // 로딩 상태 제거
                removeLoadingState('system');
            } catch (error) {
                console.error('시스템 개요 업데이트 오류:', error);
                // 오류 시에도 로딩 상태 제거
                removeLoadingState('system');
            }
        }

        // 시스템 모니터링 차트 업데이트
        function updateSystemMonitoringCharts(uptime, dbSize, apiResponseTime) {
            try {
                // Chart.js가 로드되었는지 확인
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js가 로드되지 않았습니다.');
                    return;
                }

                // 기존 차트 제거
                const existingCharts = document.querySelectorAll('canvas');
                existingCharts.forEach(canvas => {
                    if (canvas.chart) {
                        canvas.chart.destroy();
                    }
                });

                // API 응답시간 차트
                const apiResponseCtx = document.getElementById('apiResponseChart');
                if (apiResponseCtx) {
                    const apiResponseChart = new Chart(apiResponseCtx, {
                        type: 'line',
                        data: {
                            labels: ['1시간', '2시간', '3시간', '4시간', '5시간', '6시간', '7시간', '8시간', '9시간', '10시간'],
                            datasets: [{
                                label: 'API 응답시간 (ms)',
                                data: [apiResponseTime.hour1, apiResponseTime.hour2, apiResponseTime.hour3, apiResponseTime.hour4, apiResponseTime.hour5, apiResponseTime.hour6, apiResponseTime.hour7, apiResponseTime.hour8, apiResponseTime.hour9, apiResponseTime.hour10],
                                borderColor: 'rgb(75, 192, 192)',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                    apiResponseCtx.chart = apiResponseChart;
                }

                // 데이터베이스 사용량 차트
                const dbUsageCtx = document.getElementById('dbUsageChart');
                if (dbUsageCtx) {
                    const dbUsageChart = new Chart(dbUsageCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['사용 중', '사용 가능'],
                            datasets: [{
                                data: [dbSize.used_bytes, dbSize.free_bytes],
                                backgroundColor: ['rgb(54, 162, 235)', 'rgb(201, 203, 207)']
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'top',
                                },
                                title: {
                                    display: true,
                                    text: '데이터베이스 사용률'
                                }
                            }
                        }
                    });
                    dbUsageCtx.chart = dbUsageChart;
                }

                // API 호출량 차트
                const apiCallsCtx = document.getElementById('apiCallsChart');
                if (apiCallsCtx) {
                    const apiCallsChart = new Chart(apiCallsCtx, {
                        type: 'bar',
                        data: {
                            labels: ['1시간', '2시간', '3시간', '4시간', '5시간', '6시간', '7시간', '8시간', '9시간', '10시간'],
                            datasets: [{
                                label: 'API 호출 수',
                                data: [apiResponseTime.hour1, apiResponseTime.hour2, apiResponseTime.hour3, apiResponseTime.hour4, apiResponseTime.hour5, apiResponseTime.hour6, apiResponseTime.hour7, apiResponseTime.hour8, apiResponseTime.hour9, apiResponseTime.hour10],
                                backgroundColor: 'rgb(153, 102, 255)'
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                    apiCallsCtx.chart = apiCallsChart;
                }

                // 시스템 리소스 차트
                const systemResourcesCtx = document.getElementById('systemResourcesChart');
                if (systemResourcesCtx) {
                    const systemResourcesChart = new Chart(systemResourcesCtx, {
                        type: 'line',
                        data: {
                            labels: ['CPU', '메모리', '디스크'],
                            datasets: [{
                                label: '사용률 (%)',
                                data: [uptime.cpu_usage, uptime.memory_usage, uptime.disk_usage],
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                    systemResourcesCtx.chart = systemResourcesChart;
                }
            } catch (error) {
                console.error('차트 생성 중 오류:', error);
            }
        }

        // 데이터베이스 테이블 정보 업데이트
        function updateDatabaseTablesInfo(logFiles) {
            const container = document.getElementById('db-tables-info');
            container.innerHTML = ''; // 기존 내용 지우기

            if (logFiles.tables && logFiles.tables.length > 0) {
                logFiles.tables.forEach(table => {
                    container.innerHTML += `
                        <tr>
                            <td>${table.table_name}</td>
                            <td>${table.row_count}</td>
                            <td>${table.size}</td>
                            <td>${new Date(table.last_update).toLocaleDateString('ko-KR')}</td>
                        </tr>
                    `;
                });
            } else {
                container.innerHTML = '<tr><td colspan="4" class="text-center text-muted py-4">데이터베이스 테이블 정보가 없습니다.</td></tr>';
            }
        }

        // API 사용량 통계 업데이트
        function updateApiUsageStats(logFiles) {
            const container = document.getElementById('api-usage-stats');
            container.innerHTML = ''; // 기존 내용 지우기

            if (logFiles.api_calls) {
                Object.keys(logFiles.api_calls).forEach(service => {
                    const callsToday = logFiles.api_calls[service].today || 0;
                    const callsWeek = logFiles.api_calls[service].week || 0;
                    const callsMonth = logFiles.api_calls[service].month || 0;
                    const successRate = logFiles.api_calls[service].success_rate || 0;
                    const avgResponseTime = logFiles.api_calls[service].avg_response_time || 0;

                    container.innerHTML += `
                        <tr>
                            <td>${service}</td>
                            <td>${callsToday}</td>
                            <td>${callsWeek}</td>
                            <td>${callsMonth}</td>
                            <td>${successRate}%</td>
                            <td>${avgResponseTime}ms</td>
                        </tr>
                    `;
                });
            } else {
                container.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-4">API 사용량 통계가 없습니다.</td></tr>';
            }
        }

        // API 키 상태 업데이트
        function updateApiKeysStatus(logFiles) {
            const container = document.getElementById('api-keys-status');
            container.innerHTML = ''; // 기존 내용 지우기

            if (logFiles.api_keys) {
                Object.keys(logFiles.api_keys).forEach(service => {
                    const status = logFiles.api_keys[service].status || 'N/A';
                    const lastChecked = logFiles.api_keys[service].last_checked ? new Date(logFiles.api_keys[service].last_checked).toLocaleDateString('ko-KR') : 'N/A';
                    container.innerHTML += `
                        <tr>
                            <td>${service}</td>
                            <td>${status}</td>
                            <td>${lastChecked}</td>
                        </tr>
                    `;
                });
            } else {
                container.innerHTML = '<tr><td colspan="3" class="text-center text-muted py-4">API 키 상태가 없습니다.</td></tr>';
            }
        }

        // 로그 레벨 차트 업데이트
        function updateLogLevelChart(logFiles) {
            try {
                const container = document.getElementById('logLevelChart');
                if (!container) {
                    console.error('logLevelChart 요소를 찾을 수 없습니다.');
                    return;
                }

                // Chart.js가 로드되었는지 확인
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js가 로드되지 않았습니다.');
                    container.innerHTML = '<div class="text-center text-muted py-4">차트를 로드할 수 없습니다.</div>';
                    return;
                }

                if (logFiles.log_levels) {
                    const labels = Object.keys(logFiles.log_levels);
                    const data = Object.values(logFiles.log_levels);

                    // 기존 차트 제거
                    if (container.chart) {
                        container.chart.destroy();
                    }

                    const logLevelChart = new Chart(container, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '로그 수',
                                data: data,
                                backgroundColor: 'rgb(75, 192, 192)'
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                    container.chart = logLevelChart;
                } else {
                    container.innerHTML = '<div class="text-center text-muted py-4">로그 레벨 통계가 없습니다.</div>';
                }
            } catch (error) {
                console.error('로그 레벨 차트 생성 중 오류:', error);
                const container = document.getElementById('logLevelChart');
                if (container) {
                    container.innerHTML = '<div class="text-center text-muted py-4">차트 생성 중 오류가 발생했습니다.</div>';
                }
            }
        }

        // 실시간 로그 로드
        async function refreshLogs() {
            const recentLogsContainer = document.getElementById('recent-logs');
            recentLogsContainer.innerHTML = '<div class="text-center text-muted py-4">로그를 불러오는 중입니다...</div>';

            try {
                const response = await fetch('/api/v1/system/logs/recent');
                const logs = await response.json();

                if (logs.length > 0) {
                    let html = '';
                    logs.forEach(log => {
                        html += `<p class="mb-1"><span class="fw-bold">${log.level}</span> - ${log.message} (${new Date(log.timestamp).toLocaleString('ko-KR')})</p>`;
                    });
                    recentLogsContainer.innerHTML = html;
                } else {
                    recentLogsContainer.innerHTML = '<div class="text-center text-muted py-4">최근 로그가 없습니다.</div>';
                }
            } catch (error) {
                console.error('실시간 로그 로드 오류:', error);
                recentLogsContainer.innerHTML = '<div class="text-center text-muted py-4">로그를 불러오는데 실패했습니다.</div>';
            }
        }

        // 로그 다운로드
        async function downloadLogs() {
            try {
                const response = await fetch('/api/v1/system/logs/download');
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'application_logs.txt'; // 파일 이름 지정
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                showToast('로그 파일이 다운로드되었습니다.', 'success');
            } catch (error) {
                console.error('로그 다운로드 오류:', error);
                showToast('로그 파일을 다운로드하는데 실패했습니다.', 'error');
            }
        }

        // 로그 정리
        async function clearLogs() {
            if (confirm('정말로 모든 로그를 정리하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                try {
                    const response = await fetch('/api/v1/system/logs/clear', {
                        method: 'POST'
                    });
                    const result = await response.json();

                    if (result.success) {
                        showToast('모든 로그가 성공적으로 정리되었습니다.', 'success');
                        refreshLogs(); // 로그 목록 새로고침
                    } else {
                        showToast('로그 정리에 실패했습니다.', 'error');
                    }
                } catch (error) {
                    console.error('로그 정리 오류:', error);
                    showToast('로그 정리 중 오류가 발생했습니다.', 'error');
                }
            }
        }

        // 시스템 설정 저장
        async function saveSystemSettings() {
            const debugMode = document.getElementById('debug-mode').checked;
            const logLevel = document.getElementById('log-level').value;
            const backupInterval = document.getElementById('backup-interval').value;
            const cacheDuration = document.getElementById('cache-duration').value;
            const maxConcurrentRequests = document.getElementById('max-concurrent-requests').value;
            const sessionTimeout = document.getElementById('session-timeout').value;

            try {
                const response = await fetch('/api/v1/system/settings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        debug_mode: debugMode,
                        log_level: logLevel,
                        backup_interval: parseInt(backupInterval),
                        api_cache_duration: parseInt(cacheDuration),
                        max_concurrent_requests: parseInt(maxConcurrentRequests),
                        session_timeout: parseInt(sessionTimeout)
                    })
                });
                const result = await response.json();

                if (result.success) {
                    showToast('시스템 설정이 저장되었습니다.', 'success');
                } else {
                    showToast('시스템 설정 저장에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('시스템 설정 저장 오류:', error);
                showToast('시스템 설정 저장 중 오류가 발생했습니다.', 'error');
            }
        }

        // 시스템 초기화
        async function resetSystem() {
            if (confirm('정말로 시스템을 초기화하시겠습니까? 모든 데이터가 삭제됩니다.')) {
                try {
                    const response = await fetch('/api/v1/system/reset', {
                        method: 'POST'
                    });
                    const result = await response.json();

                    if (result.success) {
                        showToast('시스템이 성공적으로 초기화되었습니다. 페이지를 새로고침하여 변경사항을 확인하세요.', 'success');
                        window.location.reload(); // 페이지 새로고침
                    } else {
                        showToast('시스템 초기화에 실패했습니다.', 'error');
                    }
                } catch (error) {
                    console.error('시스템 초기화 오류:', error);
                    showToast('시스템 초기화 중 오류가 발생했습니다.', 'error');
                }
            }
        }

        // 데이터베이스 백업
        async function backupDatabase() {
            try {
                const response = await fetch('/api/v1/system/database/backup', {
                    method: 'POST'
                });
                const result = await response.json();

                if (result.success) {
                    showToast('데이터베이스 백업이 시작되었습니다.', 'info');
                    // 백업 완료 후 로그 새로고침
                    await refreshLogs();
                } else {
                    showToast('데이터베이스 백업에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('데이터베이스 백업 오류:', error);
                showToast('데이터베이스 백업 중 오류가 발생했습니다.', 'error');
            }
        }

        // 데이터베이스 최적화
        async function optimizeDatabase() {
            try {
                const response = await fetch('/api/v1/system/database/optimize', {
                    method: 'POST'
                });
                const result = await response.json();

                if (result.success) {
                    showToast('데이터베이스 최적화가 시작되었습니다.', 'info');
                    // 최적화 완료 후 로그 새로고침
                    await refreshLogs();
                } else {
                    showToast('데이터베이스 최적화에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('데이터베이스 최적화 오류:', error);
                showToast('데이터베이스 최적화 중 오류가 발생했습니다.', 'error');
            }
        }

        // 간단한 메뉴 클릭 핸들러
        function handleMenuClick(section) {
            console.log('메뉴 클릭:', section);

            // 메뉴 활성화
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            const targetLink = document.querySelector(`.nav-link[onclick*="showContent('${section}')"]`);
            if (targetLink) {
                targetLink.classList.add('active');
            }

            // 콘텐츠 표시
            document.querySelectorAll('.content-section').forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });

            const targetContent = document.getElementById(`${section}-content`);
            if (targetContent) {
                targetContent.style.display = 'block';
                targetContent.classList.add('active');

                // 즉시 데이터 로드
                loadSectionDataDirect(section);
            }
        }

        // 직접 데이터 로드 함수
        async function loadSectionDataDirect(section) {
            console.log('직접 데이터 로드:', section);

            try {
                switch (section) {
                    case 'posts':
                        const postsResponse = await fetch('/api/v1/posts');
                        const postsData = await postsResponse.json();
                        console.log('포스트 데이터:', postsData.length, '개');
                        updatePostsContainer(postsData);
                        break;

                    case 'keywords':
                        const keywordsResponse = await fetch('/api/v1/keywords');
                        const keywordsData = await keywordsResponse.json();
                        console.log('키워드 데이터:', keywordsData.length, '개');
                        updateKeywordsContainer(keywordsData);
                        break;

                    case 'news':
                        const newsResponse = await fetch('/api/v1/news-archive/');
                        const newsData = await newsResponse.json();
                        console.log('뉴스 데이터:', newsData.length, '개');
                        updateNewsContainer(newsData);
                        break;

                    case 'dashboard':
                        console.log('대시보드 데이터 직접 로드 시작');
                        try {
                            const [postsRes, keywordsRes, statsRes] = await Promise.all([
                                fetch('/api/v1/posts'),
                                fetch('/api/v1/keywords'),
                                fetch('/api/v1/stats/dashboard')
                            ]);

                            if (!postsRes.ok || !keywordsRes.ok || !statsRes.ok) {
                                throw new Error('API 응답 오류');
                            }

                            const dashboardPosts = await postsRes.json();
                            const dashboardKeywords = await keywordsRes.json();
                            const dashboardStats = await statsRes.json();

                            console.log('대시보드 데이터 로드 완료:', {
                                posts: dashboardPosts.length,
                                keywords: dashboardKeywords.length,
                                stats: dashboardStats
                            });

                            updateDashboardContainer(dashboardPosts, dashboardKeywords, dashboardStats);
                            console.log('대시보드 컨테이너 업데이트 완료');
                        } catch (error) {
                            console.error('대시보드 데이터 로드 오류:', error);
                            showToast('대시보드 데이터 로드 중 오류가 발생했습니다.', 'error');
                        }
                        break;

                    case 'updates':
                        console.log('=== 업데이트 이력 탭 활성화 ===');
                        try {
                            const updatesResponse = await fetch('/api/v1/feature-updates/history');
                            const updatesData = await updatesResponse.json();
                            console.log('업데이트 이력 데이터 로드 완료:', updatesData.length, '개');

                            // 즉시 통계 업데이트
                            console.log('통계 업데이트 시작...');
                            updateUpdatesContainer(updatesData);
                            updateUpdatesStats(updatesData);
                            updateUpdateHistoryStats(updatesData);
                            updateDetailedStats(updatesData);

                            // 강제로 통계 요소들 업데이트
                            const stats = {
                                'total-updates': updatesData.length,
                                'uiux-updates': updatesData.filter(u => u.category === 'UI/UX').length,
                                'api-updates': updatesData.filter(u => u.category === 'API').length,
                                'ai-updates': updatesData.filter(u => u.category === 'AI').length
                            };

                            console.log('강제 통계 업데이트:', stats);
                            Object.entries(stats).forEach(([id, value]) => {
                                const element = document.getElementById(id);
                                if (element) {
                                    element.textContent = value;
                                    console.log(`✅ 강제 업데이트: ${id} = ${value}`);
                                } else {
                                    console.error(`❌ 요소를 찾을 수 없음: ${id}`);
                                }
                            });

                            console.log('=== 업데이트 이력 탭 활성화 완료 ===');

                            // 추가 강제 업데이트 (탭 클릭 시)
                            setTimeout(() => {
                                console.log('탭 클릭 후 추가 강제 업데이트');
                                forceUpdateStats(updatesData);
                            }, 500);

                            // 더 긴 지연 후 한 번 더 시도
                            setTimeout(() => {
                                console.log('탭 클릭 후 최종 강제 업데이트');
                                forceUpdateStats(updatesData);
                            }, 1000);
                        } catch (error) {
                            console.error('업데이트 이력 로드 오류:', error);
                        }
                        break;
                }
            } catch (error) {
                console.error('데이터 로드 오류:', error);
            }
        }

        // 성능 모니터링 관련 함수들
        let performanceUpdateInterval = null;

        // 성능 데이터 로드
        async function loadPerformanceData() {
            try {
                console.log('성능 데이터 로드 시작');

                const [statusResponse, summaryResponse, dataResponse] = await Promise.all([
                    fetch('/api/v1/performance/status'),
                    fetch('/api/v1/performance/summary'),
                    fetch('/api/v1/performance/data?limit=50')
                ]);

                const status = await statusResponse.json();
                const summary = await summaryResponse.json();
                const data = await dataResponse.json();

                updatePerformanceUI(status, summary, data);
                console.log('성능 데이터 로드 완료');

            } catch (error) {
                console.error('성능 데이터 로드 오류:', error);
                showToast('성능 데이터 로드 중 오류가 발생했습니다.', 'error');
            }
        }

        // 성능 UI 업데이트
        function updatePerformanceUI(status, summary, data) {
            // 실시간 통계 업데이트
            if (status.is_running) {
                document.getElementById('real-time-cpu').textContent = `${status.current_cpu || 0}%`;
                document.getElementById('real-time-memory').textContent = `${status.current_memory || 0}%`;
                document.getElementById('api-response-avg').textContent = `${status.avg_api_response_time || 0}ms`;
                document.getElementById('content-generation-status').textContent = status.content_generation_status || '정상';
            }

            // 성능 차트 업데이트
            updatePerformanceCharts(data);

            // 성능 데이터 테이블 업데이트
            updatePerformanceTable(data);

            // 알림 업데이트
            updatePerformanceAlerts(summary);
        }

        // 성능 차트 업데이트
        function updatePerformanceCharts(data) {
            // 시스템 성능 차트
            const systemCtx = document.getElementById('systemPerformanceChart');
            if (systemCtx && data.length > 0) {
                const labels = data.slice(-20).map(d => new Date(d.timestamp).toLocaleTimeString());
                const cpuData = data.slice(-20).map(d => d.system?.cpu_usage || 0);
                const memoryData = data.slice(-20).map(d => d.system?.memory_usage || 0);

                new Chart(systemCtx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'CPU (%)',
                            data: cpuData,
                            borderColor: '#007bff',
                            backgroundColor: 'rgba(0, 123, 255, 0.1)',
                            tension: 0.4
                        }, {
                            label: '메모리 (%)',
                            data: memoryData,
                            borderColor: '#ffc107',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // API 성능 차트
            const apiCtx = document.getElementById('apiPerformanceChart');
            if (apiCtx && data.length > 0) {
                const labels = data.slice(-20).map(d => new Date(d.timestamp).toLocaleTimeString());
                const apiData = data.slice(-20).map(d => {
                    const apiTimes = Object.values(d.api || {}).map(api => api.response_time || 0);
                    return apiTimes.length > 0 ? apiTimes.reduce((a, b) => a + b, 0) / apiTimes.length : 0;
                });

                new Chart(apiCtx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'API 응답시간 (ms)',
                            data: apiData,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        // 성능 데이터 테이블 업데이트
        function updatePerformanceTable(data) {
            const tableBody = document.getElementById('performance-data-table');
            if (!tableBody) return;

            tableBody.innerHTML = '';

            data.slice(-10).reverse().forEach(record => {
                const row = document.createElement('tr');
                const timestamp = new Date(record.timestamp).toLocaleString();
                const cpu = record.system?.cpu_usage || 0;
                const memory = record.system?.memory_usage || 0;
                const apiTime = Object.values(record.api || {}).reduce((sum, api) => sum + (api.response_time || 0), 0) / Math.max(Object.keys(record.api || {}).length, 1);
                const contentStatus = record.content_generation?.success ? '성공' : '실패';
                const status = record.system?.cpu_usage > 90 || record.system?.memory_usage > 85 ? '경고' : '정상';

                row.innerHTML = `
                    <td>${timestamp}</td>
                    <td>${cpu.toFixed(1)}%</td>
                    <td>${memory.toFixed(1)}%</td>
                    <td>${apiTime.toFixed(0)}ms</td>
                    <td>${contentStatus}</td>
                    <td><span class="badge bg-${status === '정상' ? 'success' : 'warning'}">${status}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }

        // 성능 알림 업데이트
        function updatePerformanceAlerts(summary) {
            const alertsContainer = document.getElementById('performance-alerts');
            if (!alertsContainer) return;

            alertsContainer.innerHTML = '';

            if (summary.alerts && summary.alerts.length > 0) {
                summary.alerts.forEach(alert => {
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert alert-warning alert-dismissible fade show';
                    alertDiv.innerHTML = `
                        <i class="bi bi-exclamation-triangle"></i> ${alert}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    `;
                    alertsContainer.appendChild(alertDiv);
                });
            } else {
                alertsContainer.innerHTML = '<div class="alert alert-success"><i class="bi bi-check-circle"></i> 모든 시스템이 정상 작동 중입니다.</div>';
            }
        }

        // 성능 데이터 새로고침
        async function refreshPerformanceData() {
            showToast('성능 데이터를 새로고침 중입니다...', 'info');
            await loadPerformanceData();
            showToast('성능 데이터가 업데이트되었습니다.', 'success');
        }

        // 성능 모니터링 재시작
        async function restartPerformanceMonitor() {
            try {
                showToast('성능 모니터링을 재시작 중입니다...', 'info');

                const response = await fetch('/api/v1/performance/restart', {
                    method: 'POST'
                });

                if (response.ok) {
                    showToast('성능 모니터링이 재시작되었습니다.', 'success');
                    await loadPerformanceData();
                } else {
                    showToast('성능 모니터링 재시작에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('성능 모니터링 재시작 오류:', error);
                showToast('성능 모니터링 재시작 중 오류가 발생했습니다.', 'error');
            }
        }

        // 성능 임계값 업데이트
        async function updatePerformanceThresholds() {
            try {
                const thresholds = {
                    cpu_threshold: document.getElementById('cpu-threshold').value,
                    memory_threshold: document.getElementById('memory-threshold').value,
                    response_threshold: document.getElementById('response-threshold').value
                };

                const response = await fetch('/api/v1/system/settings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(thresholds)
                });

                if (response.ok) {
                    showToast('성능 임계값이 저장되었습니다.', 'success');
                } else {
                    showToast('성능 임계값 저장에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('성능 임계값 업데이트 오류:', error);
                showToast('성능 임계값 저장 중 오류가 발생했습니다.', 'error');
            }
        }

        // 성능 실시간 업데이트 시작
        function startPerformanceRealTimeUpdate() {
            if (performanceUpdateInterval) {
                clearInterval(performanceUpdateInterval);
            }

            performanceUpdateInterval = setInterval(async () => {
                if (currentSection === 'performance') {
                    await loadPerformanceData();
                }
            }, 30000); // 30초마다 업데이트
        }

        // 성능 실시간 업데이트 중지
        function stopPerformanceRealTimeUpdate() {
            if (performanceUpdateInterval) {
                clearInterval(performanceUpdateInterval);
                performanceUpdateInterval = null;
            }
        }

        // 메뉴 네비게이션 테스트 함수
        async function testMenuNavigation() {
            console.log('=== 메뉴 네비게이션 테스트 시작 ===');

            const sections = ['posts', 'keywords', 'news'];

            for (let i = 0; i < sections.length; i++) {
                const section = sections[i];
                console.log(`테스트 ${i + 1}: ${section} 섹션`);

                // 섹션으로 이동
                showContent(section);

                // 1초 대기
                await new Promise(resolve => setTimeout(resolve, 1000));

                // 데이터 로드 확인
                const container = document.getElementById(`${section}-container`);
                if (container) {
                    console.log(`${section} 컨테이너 존재:`, container.innerHTML.length > 0);
                } else {
                    console.error(`${section} 컨테이너를 찾을 수 없습니다.`);
                }
            }

            // 대시보드로 돌아가기
            showContent('dashboard');
            console.log('=== 메뉴 네비게이션 테스트 완료 ===');
        }

        // 실시간 데이터 업데이트 시스템
        let realtimeUpdateInterval;

        // 실시간 업데이트 시작 (성능 최적화)
        function startRealtimeUpdates() {
            if (realtimeUpdateInterval) {
                clearInterval(realtimeUpdateInterval);
            }

            // 초기 데이터 로드
            updateDashboardStats();

            // 30초마다 업데이트 (성능 최적화)
            realtimeUpdateInterval = setInterval(async () => {
                // 현재 활성 섹션에 따라 선택적 업데이트
                if (currentSection === 'dashboard') {
                    await updateDashboardStats();
                } else if (currentSection === 'performance') {
                    await loadPerformanceData();
                } else if (currentSection === 'posts') {
                    await refreshPosts();
                } else if (currentSection === 'keywords') {
                    await refreshKeywords();
                }
            }, 30000);
        }

        // 실시간 업데이트 중지
        function stopRealtimeUpdates() {
            if (realtimeUpdateInterval) {
                clearInterval(realtimeUpdateInterval);
                realtimeUpdateInterval = null;
            }
        }

        // 대시보드 통계 실시간 업데이트 (성능 최적화)
        let dashboardStatsCache = null;
        let lastDashboardUpdate = 0;
        const DASHBOARD_CACHE_TTL = 10000; // 10초 캐시

        async function updateDashboardStats() {
            try {
                const now = Date.now();

                // 캐시된 데이터가 있고 TTL이 유효한 경우 캐시 사용
                if (dashboardStatsCache && (now - lastDashboardUpdate) < DASHBOARD_CACHE_TTL) {
                    updateDashboardUI(dashboardStatsCache);
                    return;
                }

                const response = await fetch('/api/v1/admin/posts/stats');
                if (response.ok) {
                    const stats = await response.json();

                    // 캐시 업데이트
                    dashboardStatsCache = stats;
                    lastDashboardUpdate = now;

                    // UI 업데이트
                    updateDashboardUI(stats);

                    // 애니메이션 효과
                    animateStatUpdate();
                } else {
                    console.error('대시보드 통계 응답 오류:', response.status);
                    showModernToast('대시보드 데이터를 불러올 수 없습니다.', 'error');
                }
            } catch (error) {
                console.error('대시보드 통계 업데이트 오류:', error);
                showModernToast('대시보드 업데이트 중 오류가 발생했습니다.', 'error');
            }
        }

        // 대시보드 UI 업데이트 함수
        function updateDashboardUI(stats) {
            const elements = {
                'total-posts': stats.total_posts || 0,
                'total-keywords': stats.total_keywords || 0,
                'api-calls-today': stats.api_calls_today || 0,
                'crawl-success-rate': stats.crawl_success_rate ? `${stats.crawl_success_rate}%` : '0%'
            };

            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            });
        }

        // 통계 업데이트 애니메이션
        function animateStatUpdate() {
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(number => {
                number.style.transform = 'scale(1.05)';
                number.style.transition = 'transform 0.3s ease';

                setTimeout(() => {
                    number.style.transform = 'scale(1)';
                }, 300);
            });
        }

        // 현대적인 토스트 알림 시스템
        function showModernToast(message, type = 'info', duration = 3000) {
            const toastContainer = document.getElementById('toast-container') || createToastContainer();

            const toast = document.createElement('div');
            toast.className = `toast-item toast-${type}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <i class="bi bi-${getToastIcon(type)}"></i>
                    <span>${message}</span>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="bi bi-x"></i>
                </button>
            `;

            toastContainer.appendChild(toast);

            // 애니메이션 효과
            setTimeout(() => toast.classList.add('show'), 100);

            // 자동 제거
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // 토스트 아이콘 매핑
        function getToastIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle'
            };
            return icons[type] || 'info-circle';
        }

        // 토스트 컨테이너 생성
        function createToastContainer() {
            const container = document.createElement('div');
            container.id = 'toast-container';
            container.className = 'toast-container';
            document.body.appendChild(container);
            return container;
        }

        // 페이지 로드 시 초기화 (성능 최적화)
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Admin 페이지 로딩 시작...');

            // 토스트 컨테이너 생성
            createToastContainer();

            // 초기 대시보드 데이터 로드 (비동기)
            setTimeout(() => {
                loadDashboardData();
            }, 100);

            // 실시간 업데이트 시작 (지연)
            setTimeout(() => {
                startRealtimeUpdates();
            }, 500);

            console.log('Admin 페이지가 성공적으로 로드되었습니다.');
        });

        // 페이지 언로드 시 정리 (메모리 최적화)
        window.addEventListener('beforeunload', function () {
            console.log('Admin 페이지 정리 중...');

            // 실시간 업데이트 중지
            stopRealtimeUpdates();

            // 성능 모니터링 중지
            stopPerformanceRealTimeUpdate();

            // 시스템 모니터링 중지
            stopSystemRealTimeUpdate();

            // 캐시 정리
            dashboardStatsCache = null;

            console.log('Admin 페이지 정리 완료');
        });

        // 테스트 세션 생성 함수
        async function createTestSession() {
            try {
                showModernToast('테스트 세션을 생성하는 중...', 'info');

                const response = await fetch('/admin/test-session');
                const result = await response.json();

                if (result.success) {
                    showModernToast('테스트 세션이 생성되었습니다!', 'success');

                    // 1초 후 페이지 새로고침
                    setTimeout(() => {
                        window.location.reload();
                    }, 1000);
                } else {
                    showModernToast('테스트 세션 생성에 실패했습니다.', 'error');
                }
            } catch (error) {
                console.error('테스트 세션 생성 오류:', error);
                showModernToast('테스트 세션 생성 중 오류가 발생했습니다.', 'error');
            }
        }

        // 성능 모니터링 함수들
        let performanceDataCache = null;
        let lastPerformanceUpdate = 0;
        const PERFORMANCE_CACHE_TTL = 15000; // 15초 캐시

        async function loadPerformanceData() {
            try {
                const now = Date.now();

                // 캐시된 데이터가 있고 TTL이 유효한 경우 캐시 사용
                if (performanceDataCache && (now - lastPerformanceUpdate) < PERFORMANCE_CACHE_TTL) {
                    updatePerformanceUI(performanceDataCache);
                    return;
                }

                const response = await fetch('/api/v1/performance/status');
                if (response.ok) {
                    const data = await response.json();

                    // 캐시 업데이트
                    performanceDataCache = data;
                    lastPerformanceUpdate = now;

                    // UI 업데이트
                    updatePerformanceUI(data);
                } else {
                    console.error('성능 데이터 응답 오류:', response.status);
                    showModernToast('성능 데이터를 불러올 수 없습니다.', 'error');
                }
            } catch (error) {
                console.error('성능 데이터 로드 오류:', error);
                showModernToast('성능 데이터 로드 중 오류가 발생했습니다.', 'error');
            }
        }

        function updatePerformanceUI(data) {
            // CPU 사용률 업데이트
            const cpuElement = document.getElementById('cpu-usage');
            if (cpuElement && data.cpu_usage !== undefined) {
                cpuElement.textContent = `${data.cpu_usage.toFixed(1)}%`;
            }

            // 메모리 사용률 업데이트
            const memoryElement = document.getElementById('memory-usage');
            if (memoryElement && data.memory_usage !== undefined) {
                memoryElement.textContent = `${data.memory_usage.toFixed(1)}%`;
            }

            // 응답 시간 업데이트
            const responseElement = document.getElementById('response-time');
            if (responseElement && data.avg_response_time !== undefined) {
                responseElement.textContent = `${data.avg_response_time.toFixed(2)}ms`;
            }
        }

        // Admin 페이지 통합 테스트 함수
        async function testAdminIntegration() {
            try {
                showModernToast('통합 테스트를 시작합니다...', 'info');

                const startTime = performance.now();

                const response = await fetch('/api/v1/admin/test-integration');
                const result = await response.json();

                const endTime = performance.now();
                const responseTime = endTime - startTime;

                if (result.success) {
                    showModernToast(`통합 테스트 성공! (${responseTime.toFixed(2)}ms)`, 'success');
                    console.log('통합 테스트 결과:', result);
                    console.log(`응답 시간: ${responseTime.toFixed(2)}ms`);
                } else {
                    showModernToast('통합 테스트 실패: ' + result.message, 'error');
                    console.error('통합 테스트 실패:', result);
                }
            } catch (error) {
                console.error('통합 테스트 오류:', error);
                showModernToast('통합 테스트 중 오류가 발생했습니다.', 'error');
            }
        }

        // 성능 벤치마크 테스트 함수
        async function runPerformanceBenchmark() {
            try {
                showModernToast('성능 벤치마크를 시작합니다...', 'info');

                const tests = [
                    { name: '통합 테스트', url: '/api/v1/admin/test-integration' },
                    { name: '포스트 통계', url: '/api/v1/admin/posts/stats' },
                    { name: '세션 상태', url: '/admin/session-status' }
                ];

                const results = [];

                for (const test of tests) {
                    const startTime = performance.now();
                    const response = await fetch(test.url);
                    const endTime = performance.now();

                    results.push({
                        name: test.name,
                        responseTime: endTime - startTime,
                        status: response.status,
                        success: response.ok
                    });
                }

                const avgResponseTime = results.reduce((sum, r) => sum + r.responseTime, 0) / results.length;

                console.log('성능 벤치마크 결과:', results);
                console.log(`평균 응답 시간: ${avgResponseTime.toFixed(2)}ms`);

                showModernToast(`성능 벤치마크 완료! 평균: ${avgResponseTime.toFixed(2)}ms`, 'success');

                return results;
            } catch (error) {
                console.error('성능 벤치마크 오류:', error);
                showModernToast('성능 벤치마크 중 오류가 발생했습니다.', 'error');
            }
        }
    </script>
</body>

</html>